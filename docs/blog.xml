<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Matthew B. Jané</title>
<link>https://matthewbjane.com/blog.html</link>
<atom:link href="https://matthewbjane.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>Website for Matthew B. Jané. PhD student at the University of Connecticut.</description>
<generator>quarto-1.5.56</generator>
<lastBuildDate>Fri, 23 May 2025 04:00:00 GMT</lastBuildDate>
<item>
  <title>When Evidence Synthesis Obscures: A Critique of Meta-Meta-Analyses</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-11.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Support my work&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="the-problems-in-plain-english" class="level2">
<h2 class="anchored" data-anchor-id="the-problems-in-plain-english">The problems in plain english</h2>
<section id="stacking-flaws-on-flaws" class="level3">
<h3 class="anchored" data-anchor-id="stacking-flaws-on-flaws">Stacking flaws on flaws</h3>
<p>The foundational problem with meta-meta-analyses is that they stack methodological vulnerabilities at two levels: the primary studies and the meta-analyses themselves. When you synthesize meta-analyses quantitatively, you are not working with clean, raw data–you are inheriting the full scope of methodological baggage of every meta-analysis you include.</p>
<p>This means your summary estimate is downstream of two levels of potential error: study-level errors (e.g., flawed study designs, biased outcome reporting, inadequate controls, miscalculations, etc.) and meta-analytic error (compounded by meta-analytic decisions, inclusion/exclusion criteria, modeling choices, effect size miscalculations, study coding errors, etc.). It’s not just “garbage in, garbage out”—it’s garbage in, then reprocessed and repackaged by another potentially flawed process, and then aggregated again. Think of it like a synthetic CDO (CDO²) from the 2008 financial crisis. Risky subprime mortgages were bundled into CDOs, which were then bundled again into even more complex financial products—each layer obscuring the original risk (see the <a href="https://jamesclaims.substack.com/p/the-meta-analysis-as-cdo">following substack article by James Heathers</a> that I took this analogy from). Meta-meta-analyses do the same: the result may look polished, but it’s far removed from the original evidence and just as prone to collapse under scrutiny.</p>
<p>By the time a number is produced at the end of a meta-meta-analysis, it’s often impossible to disentangle where the bias originates or how severely it distorts the result (see Brandolini’s law, which states that the amount of energy needed to refute nonsense is an order of magnitude greater than to produce it). The process compounds issues, but conceals it under the guise of a comprehensive evidence synthesis. Rather than clarifying what we know, meta-meta-analyses risk amplifying what we misunderstand.</p>
</section>
<section id="heterogeneity-at-the-wrong-level" class="level3">
<h3 class="anchored" data-anchor-id="heterogeneity-at-the-wrong-level">Heterogeneity at the wrong level</h3>
<p>In a standard meta-analysis, heterogeneity denotes the variation in effect sizes across individual studies—variation we can often explain through study-level characteristics like population differences, intervention types, or methodological quality. But in a meta-meta-analysis, heterogeneity refers to differences between meta-analyses. It doesn’t tell us much–it’s confounded by differences in analytic decisions, inclusion/exclusion criteria, or year when the literature search was conducted rather than substantive study differences. Additionally, if heterogeneity is low, it might give the misleading impression that the literature is consistent and homogeneous, even though the homogeneity is simply product of an additional layer of abstraction.</p>
<p>In effect, quantifying heterogeneity at the meta-meta-analysis level is meaningless and strips away the meaningful variation across studies.</p>
</section>
<section id="violated-independence" class="level3">
<h3 class="anchored" data-anchor-id="violated-independence">Violated independence</h3>
<p>An assumption in meta-analysis is that the effect sizes being pooled are statistically independent. Meta-meta-analyses routinely violate this by including multiple meta-analyses that draw from overlapping sets of primary studies. This redundancy creates dependencies in the data–artificially inflating the weight of certain studies and distorting both estimates and standard errors.</p>
<p>Study overlap is often assessed using the Corrected Covered Area (CCA) index, which quantifies the degree of duplication across meta-analyses. However, instead of being incorporated into the statistical model, CCA is typically used only as a filter: meta-analyses with “too much” overlap are excluded based on arbitrary thresholds—slight (&lt;5%), moderate (6–10%), high (11–15%), or very high (&gt;15%).</p>
<p>But filtering is not modeling. It does nothing to correct for the underlying statistical dependence among effect sizes. Even small amounts of undetected or uncorrected overlap can lead to inflated precision and misleading conclusions. Meta-meta-analyses that ignore this problem are reporting uncertainty that is unjustifiably narrow, and conclusions that are more confident than the data allow.</p>
</section>
<section id="what-are-we-even-estimating" class="level3">
<h3 class="anchored" data-anchor-id="what-are-we-even-estimating">What Are We Even Estimating?</h3>
<p>At the heart of any serious statistical analysis is a clearly defined estimand–the specific quantity of scientific interest. In a well-designed meta-analysis, the estimand might be something like the average treatment effect across a defined population of studies, under ideal conditions, or within a particular subgroup. Even then, identifying and justifying the estimand is no trivial task.</p>
<p>In a meta-meta-analysis, the situation becomes obscured. What exactly does the mean of mean effect sizes represent? It’s not the average effect across all studies–those are hidden inside the meta-analyses. It’s not the average effect across all populations, interventions, or outcomes–those are inconsistently defined and often incommensurable across meta-analyses.</p>
<p>Instead, we’re left with an undefined quantity that bears no clear relationship to any real-world intervention or scientific question. It floats free of context, untethered to a well-specified target.</p>
<p>This lack of a coherent estimand makes interpretation not just difficult, but arguably meaningless. Without knowing what question you’re answering, the answer–however precisely computed–is at best ambiguous, and at worst, misleading.</p>
</section>
<section id="the-only-workable-solution-meta-analyze-the-primary-studies-themselves" class="level3">
<h3 class="anchored" data-anchor-id="the-only-workable-solution-meta-analyze-the-primary-studies-themselves">The only workable solution: meta-analyze the primary studies themselves</h3>
<p>If your goal is to synthesize the research results in a given domain that has already been meta-analyzed multiple times, the most principled approach is also the most labor-intensive: extract all the unique primary studies from each meta-analysis and conduct a standard meta-analysis yourself. This allows for consistent inclusion criteria, uniform effect size calculation, proper handling of duplicate studies, consistent analytic decisions–none of which can be guaranteed when simply pooling published meta-analyses.</p>
<p>Yes, this takes time. Yes, it requires manual effort. But good science isn’t supposed to be fast. When you synthesize at the study level, you maintain control over what’s included, how it’s coded, and how quality is assessed. You can examine moderator variables properly, assess publication bias, and apply up-to-date modeling strategies. You’re synthesizing evidence, not recycling others’ summaries.</p>
<p>Meta-meta-analyses trade precision and rigor for expediency. If your aim is rigor, there’s no substitute for doing the hard work.</p>
</section>
<section id="authority-without-rigor" class="level3">
<h3 class="anchored" data-anchor-id="authority-without-rigor">Authority Without Rigor</h3>
<p>Meta-meta-analyses may appear to be at the tippity-top of the evidence hierarchy. But this appearance of authority is largely unearned because of the reasons previously described. Despite this, meta-meta-analyses will undoubtedly be communicated as the authoritative piece in a literature, because after all, they are meta-analyses OF META-ANALYSES. But stacking flaws on flaws doesn’t produce clarity–it produces a false sense of confidence.</p>
</section>
</section>
<section id="modeling-the-madness" class="level2">
<h2 class="anchored" data-anchor-id="modeling-the-madness">Modeling the Madness</h2>
<p>Let’s formalize a statistical model that attempts to represent what a meta-meta-analysis is doing. Suppose we try to model each mean effect size <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_%7Bm%7D"> from meta-analysis <img src="https://latex.codecogs.com/png.latex?m"> as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Cmu%7D_%7Bm%7D%20=%20%5Cpsi%20+%20%5Cxi_%7Bm%7D%20+%20%5Cvarepsilon_%7Bm%7D%0A"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cpsi"> is the mean of means effect sizes across meta-analyses,</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cxi_m%20%5Csim%20%5Cmathcal%7BN%7D(0,%20%5Cphi%5E2)"> captures variability <em>between</em> meta-analyses,</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_%7Bm%7D%20%5Csim%20%5Cmathcal%7BN%7D(0,%20%5Csigma%5E2)"> is the deviations due to within-meta-analysis variance for meta-analysis <img src="https://latex.codecogs.com/png.latex?m">. This would ultimately encompass both between-study variance and sampling error.</li>
</ul>
<p>At first glance, this looks like a reasonable hierarchical model. But in practice, it quickly becomes untenable.</p>
<section id="problem-1-the-estimand-is-unclear" class="level3">
<h3 class="anchored" data-anchor-id="problem-1-the-estimand-is-unclear">Problem 1: The Estimand Is Unclear</h3>
<p>What exactly does <img src="https://latex.codecogs.com/png.latex?%5Cpsi"> represent? In this model, it’s defined as <img src="https://latex.codecogs.com/png.latex?%5Cpsi%20=%20%5Cmathbb%7BE%7D(%5Chat%7B%5Cmu%7D_m)">—the expected value of mean effect sizes across meta-analyses. But this immediately raises a deeper problem: what is the expectation <em>over</em>? That is, what is the population of meta-analyses being sampled from? Meta-analyses differ in scope, inclusion criteria, populations, outcome definitions, and effect size metrics. There’s no well-defined superpopulation of meta-analyses to anchor this expectation, making <img src="https://latex.codecogs.com/png.latex?%5Cpsi"> hard to interpret in any meaningful way.</p>
<p>Rather than estimating a coherent treatment effect, <img src="https://latex.codecogs.com/png.latex?%5Cpsi"> becomes a <em>statistical artifact</em> rather than a well-defined scientific quantity.</p>
</section>
<section id="problem-2-phi2-is-unexplainable" class="level3">
<h3 class="anchored" data-anchor-id="problem-2-phi2-is-unexplainable">Problem 2: <img src="https://latex.codecogs.com/png.latex?%5Cphi%5E2"> Is Unexplainable</h3>
<p>In this model, <img src="https://latex.codecogs.com/png.latex?%5Cphi%5E2"> captures the variance in effect size estimates <em>between</em> meta-analyses. In principle, this is analogous to heterogeneity (<img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2">) in a regular meta-analysis, which we often explore using study-level moderators. But in meta-meta-analysis, we lose that resolution entirely.</p>
<p>First, we typically don’t have access to the raw study data needed to evaluate moderators meaningfully. Second–and more subtly–even when individual meta-analyses stratify by useful variables (e.g., age, dosage, study quality), that information becomes highly coarse or inconsistent at the meta-meta level. One meta-analysis may define “high quality” based on blinding; another based on sample size; a third may not define it at all. These moderator definitions are not harmonized, and their meaning shifts between meta-analyses.</p>
<p>As a result, <img src="https://latex.codecogs.com/png.latex?%5Cphi%5E2"> becomes a kind of unexplained, uninterpretable heterogeneity–absorbing all the differences in methods, populations, metrics, and contexts that vary across meta-analyses. It’s a variance you can estimate, but not interpret. The model gives you a number, but no meaningful insight.</p>
</section>
<section id="problem-3-assumes-independence-ignores-overlap" class="level3">
<h3 class="anchored" data-anchor-id="problem-3-assumes-independence-ignores-overlap">Problem 3: Assumes Independence, Ignores Overlap</h3>
<p>Although this point might seem trivial given that both <img src="https://latex.codecogs.com/png.latex?%5Cpsi"> and <img src="https://latex.codecogs.com/png.latex?%5Cphi%5E2"> already lack clear meaning, it’s worth emphasizing that the model also violates a basic statistical assumption: independence. The model treats each meta-analysis estimate <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_m"> as if it were generated from a distinct, non-overlapping set of primary studies. In reality, that’s rarely the case.</p>
<p>Primary studies are often included in multiple meta-analyses, sometimes dozens of them. This overlap introduces dependencies among the <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_m"> values that are not modeled—leading to two serious problems. First, duplicated studies are effectively given more weight, biasing the overall estimate <img src="https://latex.codecogs.com/png.latex?%5Cpsi">. Second, standard errors and confidence intervals become artificially narrow because the model assumes more information than actually exists.</p>
<p>While metrics like the Corrected Covered Area (CCA) can detect this redundancy, they are usually applied only as loose diagnostics—if at all—and not integrated into the analysis itself. Even modest levels of unmodeled overlap can skew results and inflate certainty.</p>
<p>In short, meta-meta-analyses don’t just suffer from vague estimands and uninterpretable variance—they also fail to meet the most basic statistical requirements for valid inference.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>By stacking flawed summaries on top of each other, meta-meta-analyses obscure more than they reveal. Without a clear estimand, consistent methods, or proper handling of dependencies, the numbers they produce may look rigorous–but lack real meaning.</p>
<p>If we care about getting the science right, there’s no substitute for going back to the primary studies. Synthesis is valuable, but shortcuts aren’t.</p>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>Methods</category>
  <category>Meta-Analysis</category>
  <category>Meta-Meta-Analyses</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-11.html</guid>
  <pubDate>Fri, 23 May 2025 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Individual Person Data (IPD) Meta-Analysis with Beta Regression in a Repeated-Measures Cross-Over Design</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-10.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Support my work&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="description-of-the-meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="description-of-the-meta-analysis">Description of the Meta-analysis</h2>
<section id="study-design" class="level4">
<h4 class="anchored" data-anchor-id="study-design">Study design</h4>
<p>The studies in this meta-analysis are investigating if auditory stimuli during slow-wave sleep can enhance overnight memory retention (this is based on theoretical reasons we don’t need to get into). In each study the participants undergo two sleep sessions reflecting two conditions. In one of the sessions, auditory stimuli (i.e., pink noise bursts) were presented while the subject’s were in deep slow-wave sleep (“stim” condition). In the other session there was no auditory stimuli (“sham” condition). These sleep sessions were separated by a week (or two) and were counter-balanced such that the ordering of conditions were randomized. Before subject’s go to sleep, subjects were given word-pairs that they are required to memorize. Prior to falling asleep they are assessed on how many word-pairs they can accurately remember (they are given one word and they are told to recall the other word). After the subjects wake up, they are assessed on the same task and the number of word-pairs they can remember correctly. So ultimately we have a repeated-measures (pre-post) cross-over (treatment-control) design.</p>
<p>We can load in the necessary packages <span class="citation" data-cites="tidyverse">Kay (2024)</span> and get the data from my <a href="https://github.com/MatthewBJane/meta-analysis-data-code/blob/main/acoustic_stimulation_and_memory/data/individual_person_data.csv">github repository</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidybayes)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modelr)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggtext)</span>
<span id="cb1-8"></span>
<span id="cb1-9">urlfile<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/MatthewBJane/meta-analysis-data-code/refs/heads/main/acoustic_stimulation_and_memory/data/individual_person_data.csv"</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">url</span>(urlfile))</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  study preSham postSham preStim postStim total_words
  &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
1 W2016      89      103      69       93         120
2 W2016      59       89      72       92         120
3 W2016      80       95      48       77         120
4 W2016      47       75      57       75         120
5 W2016      40       67      61       91         120
6 W2016      78      104      71       99         120</code></pre>
</div>
</div>
<p>We can see that each subject has four values: pre-stim, post-stim, pre-sham, and post-sham. The values denote the number of words recalled correctly and the total words column is the total number of word-pairs the subject was tasked to memorize. In total, there are 7 studies and 110 subjects.</p>
</section>
<section id="outcome-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="outcome-of-interest">Outcome of interest</h4>
<p>Across studies the total number of word-pairs in the recall task varied (range: 80-120) and, consequently, so does the number of word-pairs correctly recalled. This produced different number of correctly recalled words. For this reason, we will choose to use probability of recalling a word-pair accurately.</p>
<p>Assume <img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D%20%5Cin%20%5C%7B0,1%5C%7D"> is a Bernoulli random variable that denotes whether a word-pair has been correctly recalled (1) or not (0) for assessment <img src="https://latex.codecogs.com/png.latex?i"> and trial <img src="https://latex.codecogs.com/png.latex?j">. Let each session <img src="https://latex.codecogs.com/png.latex?i"> have it’s own probability distribution for <img src="https://latex.codecogs.com/png.latex?Y"> such that <img src="https://latex.codecogs.com/png.latex?Y_%7Bij%7D%20%5Csim%20%5Cmathrm%7BBer%7D(%5Cpi_i)"> where the parameter <img src="https://latex.codecogs.com/png.latex?%5Cpi_i"> is the <em>true</em> probability of correctly recalling a word-pair for session <img src="https://latex.codecogs.com/png.latex?i"> such that, <img src="https://latex.codecogs.com/png.latex?%5Cpi_i%20=%20%5CPr_i(Y_%7Bij%7D=1)">. Our data set will contain observed proportions <img src="https://latex.codecogs.com/png.latex?p_i%20=%20%5Cfrac%7BN_%7B%5Ctext%7Bcorrect%7D,i%7D%7D%7BN_%7B%5Ctext%7Btotal%20word-pairs%7D,i%7D%7D"> which are estimates of <img src="https://latex.codecogs.com/png.latex?%5Cpi_i">. Therefore the outcome of interest is a probability-valued random variable <img src="https://latex.codecogs.com/png.latex?%5Cpi_i"> which is measured by the observed proportion <img src="https://latex.codecogs.com/png.latex?p_i">.</p>
</section>
<section id="time-and-condition-variables" class="level4">
<h4 class="anchored" data-anchor-id="time-and-condition-variables">Time and condition variables</h4>
<p>We have two other Bernoulli random variables that represents time <img src="https://latex.codecogs.com/png.latex?T_i"> (pre=0, post=1) and condition <img src="https://latex.codecogs.com/png.latex?C_i"> (sham=0, stim=1). Of course, condition and time do not vary by trial so the subscript <img src="https://latex.codecogs.com/png.latex?j"> is removed. We can condition the probability of correctly recalling a word (<img src="https://latex.codecogs.com/png.latex?%5Cpi_i">) on values of <img src="https://latex.codecogs.com/png.latex?T_i"> and <img src="https://latex.codecogs.com/png.latex?C_i"> so that we have four possible experimental states,</p>
<ul>
<li>Pre-sleep, sham condition: <img src="https://latex.codecogs.com/png.latex?%5C;%5Cpi%5E%7B(0)%7D_%7B%5Cmathrm%7Bpre%7D,i%7D%20:=%20%5CPr_i(Y_%7Bij%7D%5C!%20=%5C!1%20%5Cmid%20T_i%5C!%20=%5C!0,%20C_i%5C!%20=%5C!0)"></li>
<li>Post-sleep, sham condition: <img src="https://latex.codecogs.com/png.latex?%5Cpi%5E%7B(0)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D%20:=%20%5CPr_i(Y_%7Bij%7D%5C!%20=%5C!1%20%5Cmid%20T_i%5C!%20=%5C!1,%20C_i%5C!%20=%5C!0)"></li>
<li>Pre-sleep, stim condition: <img src="https://latex.codecogs.com/png.latex?%5C;%5C;%5C;%5Cpi%5E%7B(1)%7D_%7B%5Cmathrm%7Bpre%7D,i%7D%20:=%20%5CPr_i(Y_%7Bij%7D%5C!%20=%5C!1%20%5Cmid%20T_i%5C!%20=%5C!0,%20C_i%5C!%20=%5C!1)"></li>
<li>Post-sleep, stim condition: <img src="https://latex.codecogs.com/png.latex?%5C;%5C;%5Cpi%5E%7B(1)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D%20:=%20%5CPr_i(Y_%7Bij%7D%5C!%20=%5C!1%20%5Cmid%20T_i%5C!%20=%5C!1,%20C_i%5C!%20=%5C!1)"></li>
</ul>
<p>Every participant has an observed proportion for all four experimental states: <img src="https://latex.codecogs.com/png.latex?p%5E%7B(0)%7D_%7B%5Cmathrm%7Bpre%7D,i%7D">, <img src="https://latex.codecogs.com/png.latex?p%5E%7B(0)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D">, <img src="https://latex.codecogs.com/png.latex?p%5E%7B(1)%7D_%7B%5Cmathrm%7Bpre%7D,i%7D">, and <img src="https://latex.codecogs.com/png.latex?p%5E%7B(1)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D">. What we want to do is make the data set long where condition is a dummy variable, this will set up our data such that we can fit an ANCOVA model in the next section.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># relabel the column headers</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pre.sham =</span> preSham, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pre.stim =</span> preStim, </span>
<span id="cb3-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">post.sham =</span> postSham, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">post.stim =</span> postStim) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add row for person id</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.after =</span> study) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make data set long so that there is one column of scores</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(pre.sham, post.sham, pre.stim, post.stim),</span>
<span id="cb3-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"session"</span>,</span>
<span id="cb3-10">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_correct"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># separate the session column into random variables time T and condition C</span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> session, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"condition"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># recode variables as factors with levels 0 and 1</span></span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> time,</span>
<span id="cb3-15">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(num_correct,total_words),</span>
<span id="cb3-16">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(person,condition,study)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clean up variable values and calculate proportions </span></span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(condition, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sham"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stim"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">study =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(study, </span>
<span id="cb3-20">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N2013"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N2015.1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N2015.2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"W2016"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H2019.1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H2019.2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S2020"</span>)),</span>
<span id="cb3-21">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rev</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ngo (2013)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ngo (2015a)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ngo (2015b)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weigenand (2016)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Henin (2019)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Henin (2019)"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Schneider (2020)"</span>))),</span>
<span id="cb3-22">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_pre =</span> num_correct_pre <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (total_words_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">005</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>total_words_pre)),</span>
<span id="cb3-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_post =</span> num_correct_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (total_words_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">005</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>total_words_post))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clean up columns</span></span>
<span id="cb3-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(study, person, condition, p_pre, p_post)</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display cleaned data set</span></span>
<span id="cb3-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  study            person condition p_pre p_post
  &lt;fct&gt;             &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 Weigenand (2016)      1 0         0.738  0.854
2 Weigenand (2016)      1 1         0.572  0.771
3 Weigenand (2016)      2 0         0.489  0.738
4 Weigenand (2016)      2 1         0.597  0.763
5 Weigenand (2016)      3 0         0.663  0.788
6 Weigenand (2016)      3 1         0.398  0.638
7 Weigenand (2016)      4 0         0.390  0.622
8 Weigenand (2016)      4 1         0.473  0.622</code></pre>
</div>
</div>
<p>Now we have columns for the proportions at pre-test and post-test for each condition. Notice that each person has two rows pertaining to the stim and sham condition.</p>
</section>
<section id="effect-size-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="effect-size-of-interest">Effect Size of Interest</h4>
<p>We would like to the estimate the effect of auditory stimulation on memory retention, so therefore we would like to compare the post-sleep recall proportion correct between conditions. Our effect size of interest can be the defined as the average difference between post-sleep recall scores in the treatment and control group conditioned on a pre-sleep score of .50,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta%20=%20%5Cmathbb%7BE%7D%5Cleft(p%5E%7B(1)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D%5C,-%20p%5E%7B(0)%7D_%7B%5Cmathrm%7Bpost%7D,i%7D%5C,%20%5Cmiddle%7C%5C,%20p_%7B%5Cmathrm%7Bpre%7D,i%7D%20=%20.50%5Cright).%0A"></p>
<p>Since this effect size is essentially an average of risk differences, conditioning on a pre-sleep value of .50 is useful as is put succinctly by <a href="https://journals.sagepub.com/doi/10.1177/23780231231192394#:~:text=Risk%20differences%20are%20useful%20when,often%20be%20a%20good%20choice.">Karlson and Quillian (2023)</a> <strong>“Risk differences are useful when base rates are in a middle range”</strong>. We will see that the IPD model will use the pre-sleep score as a covariate so conditioning on pre-sleep scores is straightforward. The grand average pre-sleep score is ~.47, which makes conditioning on .50 a bit easier to justify. We can visualize the pre-sleep scores for each study below, we can see that they are fairly evenly distributed around .50.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> p_pre, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> study)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slab</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_qi"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slab_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slab_alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_dotsinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_qi"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink2"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slab_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pre-sleep scores (proportion correct)"</span>,</span>
<span id="cb5-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Studies"</span>) </span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-10_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Distributions of pre-sleep scores by study. The dashed line denotes the 50:50 correct/incorrect value (<img src="https://latex.codecogs.com/png.latex?p_%5Cmathrm%7Bpre%7D%20=%20.5">)</figcaption>
</figure>
</div>
</div>
</div>
<p>We can interpret the effect size as: on average, a typical person sees a <img src="https://latex.codecogs.com/png.latex?%5B%5Cdelta%5Ctimes%20100%5D"> percentage point increase in accurately recalling a word-pair in the stim condition relative to the sham condition. An effect size value of <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3C%200"> would indicate reduced recall in the stim group (i.e., stim was actually detrimental relative to sham), a value between <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3E0"> would indicate increased recall in the stim group (i.e., stim was beneficial relative to sham), and a value of <img src="https://latex.codecogs.com/png.latex?%5Cdelta=1"> would be a null effect. Important to note that <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> is not standardized in this meta-analysis because scores are comparable across studies.</p>
</section>
</section>
<section id="ipd-model-pre-sleep-score-as-covariate" class="level2">
<h2 class="anchored" data-anchor-id="ipd-model-pre-sleep-score-as-covariate">IPD Model (pre-sleep score as covariate)</h2>
<p>With our data we can model the observed proportions as a beta distribution such that <img src="https://latex.codecogs.com/png.latex?p_%7B%5Cmathrm%7Bpost%7D,i%7D%20%5Csim%20%5Cmathrm%7BBeta%7D(%5Cmu_i,%5Cphi)"> where <img src="https://latex.codecogs.com/png.latex?%5Cmu_i"> is the conditional mean (i.e., <img src="https://latex.codecogs.com/png.latex?%5Cmu_i:=%5Cmathbb%7BE%7D(p_%7B%5Cmathrm%7Bpost%7D,i%7D%5C,%20%7C%5C,%20p_%7B%5Cmathrm%7Bpre%7D,i%7D,%20C_i%20)">) and <img src="https://latex.codecogs.com/png.latex?%5Cphi"> is the concentration (<img src="https://latex.codecogs.com/png.latex?%5Cphi"> is inversely related to the variance and we can obtain the variance of <img src="https://latex.codecogs.com/png.latex?p_i"> with <img src="https://latex.codecogs.com/png.latex?%5Cmu(1-%5Cmu)/(%5Cphi+1)">). We can model the logit transformed <img src="https://latex.codecogs.com/png.latex?%5Cmu_i"> with an ANCOVA type model by using the pre-sleep scores as a predictor within a regression model.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7Blogit%7D(%5Cmu_%7Bi%7D)%20%20=%20%5Cbeta_%7B0,sp%7D%20+%20%20%5Cbeta_%7B1,s%7D%5C,p_%7B%5Cmathrm%7Bpre%7D,i%7D%20+%20%5Cbeta_%7B2,s%7D%5C,%20C_i%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?C_i%5Cin%5C%7B0,1%5C%7D"> and represent the condition (0=sham, 1=stim). This means that the model-implied conditional mean is,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmu_i%20=%20%5Cfrac%7B%5Cexp(%5Cbeta_%7B0,sp%7D%20+%20%20%5Cbeta_%7B1,s%7D%5C,p_%7B%5Cmathrm%7Bpre%7D,i%7D%20+%20%5Cbeta_%7B2,s%7D%5C,%20C_i)%7D%7B1%20+%20%5Cexp(%5Cbeta_%7B0,sp%7D%20+%20%20%5Cbeta_%7B1,s%7D%5C,p_%7B%5Cmathrm%7Bpre%7D,i%7D%20+%20%5Cbeta_%7B2,s%7D%5C,%20C_i)%7D%0A"></p>
<p>To obtain person and study-level variability, we want to incorporate a random effect for study samples on each of the regression coefficients (there are 7 studies, denoted with subscript <img src="https://latex.codecogs.com/png.latex?s%20=%201...7">). We also allow the intercept to vary between individuals such that each person <img src="https://latex.codecogs.com/png.latex?p"> has a random intercept (this is reasonable since there are individual differences in recall ability). Note that having condition vary by person (each person has 2 data points pertaining to treatment-control) would produce a model that is not identifiable. We will just use the default <code>brms</code> priors for all parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bf</span>(p_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Intercept <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p_pre <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> condition <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>person) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>p_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>condition<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>study), </span>
<span id="cb6-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Beta</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"logit"</span>))</span>
<span id="cb6-3"></span>
<span id="cb6-4">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">default_prior</span>(mdl, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb6-5"></span>
<span id="cb6-6"></span>
<span id="cb6-7">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(mdl,</span>
<span id="cb6-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb6-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cores =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb6-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb6-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb6-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb6-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior =</span> prior,</span>
<span id="cb6-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ipd_meta"</span>,</span>
<span id="cb6-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file_refit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_change"</span>)</span></code></pre></div>
</div>
<p>I recommend reading A. Solomon Kurz’s awesome <a href="https://solomonkurz.netlify.app/blog/2023-06-25-causal-inference-with-beta-regression/#beta-likelihood">blog post on Beta regression for causal inference</a>, which inspired some of this model (if I made any mistakes that does not reflect on Solomon’s blog, that is just me being dense).</p>
<section id="study-level-estimates-of-delta" class="level4">
<h4 class="anchored" data-anchor-id="study-level-estimates-of-delta">Study-level estimates of <img src="https://latex.codecogs.com/png.latex?%5Cdelta"></h4>
<p>Let’s observe the posterior distribution of effects from each study in the meta-analysis. Visualizations created with the help of the awesome <code>tidybayes</code> and <code>ggdist</code> packages <span class="citation" data-cites="tidybayes">Kay (2023)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_pre =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">study =</span> dat<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>study,</span>
<span id="cb7-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_epred_draws</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> nd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allow_new_levels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>p_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>condition<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>study)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> condition,</span>
<span id="cb7-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> .epred,</span>
<span id="cb7-10">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(study,.draw)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">0</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> study)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_qi"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink3"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slab_alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Effect <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> delta),</span>
<span id="cb7-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Study-level effects"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"with 50% and 95% intervals"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-10_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Study-level posterior estimates of the expected value of <img src="https://latex.codecogs.com/png.latex?%5Cdelta"></figcaption>
</figure>
</div>
</div>
</div>
<p>In our original paper we found a strong moderating effect of publication year on the effect size. Although we were only able to get a subset of the raw data sets, you can still see the shadow of that trend appears here.</p>
</section>
<section id="mean-effect" class="level4">
<h4 class="anchored" data-anchor-id="mean-effect">Mean Effect</h4>
<p>Now we want to estimate the average effect across studies, the key here is to set the <code>re_formula</code> argument in the add_epred_draws to <code>NA</code>. The figure below denotes the distribution of plausible values for the average true effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_pre =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb8-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">study =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb8-6"></span>
<span id="cb8-7">posterior_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_epred_draws</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> nd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> condition,</span>
<span id="cb8-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> .epred,</span>
<span id="cb8-10">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> .draw) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">0</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)</span>
<span id="cb8-12"></span>
<span id="cb8-13"></span>
<span id="cb8-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> posterior_mean, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_qi"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink4"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slab_alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Effect <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> delta),</span>
<span id="cb8-21">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean effect"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"with 50% and 95% intervals"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-10_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can see there is little/no <em>average</em> effect of the stim condition 0.012 [-0.047, 0.069]. The estimate suggests there is about a 1% in recall probability difference from stim to sham.</p>
<p>Let’s now obtain the credibility intervals which tells us what in what range of <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> do <em>X%</em> of study effects fall. The figure below will show 50, 80, and 95% credibility intervals. To do this in <code>brms</code> I am like 99% sure we just need to incorporate all the study-level random effects in the <code>re_formula</code> argument again. Therefore we would want to specify it as <code>re_formula = ~(1+p_pre+condition|study)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">nd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-2">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p_pre =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb9-3">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb9-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">study =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"new_study"</span>,</span>
<span id="cb9-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_predicted_draws</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> nd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allow_new_levels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">re_formula =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>p_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>condition<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>study)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> condition,</span>
<span id="cb9-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> .prediction,</span>
<span id="cb9-10">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> .draw) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">0</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> delta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_interval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_interval =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_qi"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink4"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink3"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expression</span>(Effect <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> delta),</span>
<span id="cb9-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Credibility intervals"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intervals where 50,80,95% of study effects fall"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-10_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="diagnostics">Diagnostics</h4>
<p>Let’s observe the posterior predictive check to see if our model performed as we expected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pp_check</span>(fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hotpink"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posterior predictive check"</span>, </span>
<span id="cb10-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style = 'color:hotpink4'&gt;**observed distribution**&lt;/span&gt; and &lt;span style = 'color:hotpink'&gt;**predicted distribution**&lt;/span&gt;"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb10-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(),</span>
<span id="cb10-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"arial"</span>), </span>
<span id="cb10-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-10_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The predictive check looks quite good!</p>
<p>Anyways… thats the post. Let me know if you have any suggestions or critiques.</p>
</section>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] ggtext_0.1.2    ggdist_3.3.2    modelr_0.1.11   tidybayes_3.0.7
 [5] brms_2.22.0     Rcpp_1.0.12     lubridate_1.9.3 forcats_1.0.0  
 [9] stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2     readr_2.1.5    
[13] tidyr_1.3.1     tibble_3.2.1    ggplot2_3.5.1   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] svUnit_1.0.6         tidyselect_1.2.1     viridisLite_0.4.2   
 [4] farver_2.1.2         loo_2.8.0            fastmap_1.2.0       
 [7] tensorA_0.36.2.1     digest_0.6.36        timechange_0.3.0    
[10] lifecycle_1.0.4      StanHeaders_2.32.10  magrittr_2.0.3      
[13] posterior_1.6.0      compiler_4.4.2       rlang_1.1.4         
[16] tools_4.4.2          utf8_1.2.4           yaml_2.3.8          
[19] knitr_1.47           labeling_0.4.3       bridgesampling_1.1-2
[22] htmlwidgets_1.6.4    bit_4.0.5            pkgbuild_1.4.4      
[25] plyr_1.8.9           xml2_1.3.6           abind_1.4-8         
[28] withr_3.0.0          grid_4.4.2           stats4_4.4.2        
[31] fansi_1.0.6          colorspace_2.1-0     inline_0.3.19       
[34] scales_1.3.0         cli_3.6.3            mvtnorm_1.3-1       
[37] rmarkdown_2.27       crayon_1.5.3         generics_0.1.3      
[40] RcppParallel_5.1.9   rstudioapi_0.16.0    reshape2_1.4.4      
[43] tzdb_0.4.0           commonmark_1.9.2     rstan_2.32.6        
[46] bayesplot_1.11.1     parallel_4.4.2       matrixStats_1.4.1   
[49] vctrs_0.6.5          Matrix_1.7-1         jsonlite_1.8.8      
[52] hms_1.1.3            arrayhelpers_1.1-0   bit64_4.0.5         
[55] glue_1.7.0           codetools_0.2-20     distributional_0.4.0
[58] stringi_1.8.4        gtable_0.3.5         QuickJSR_1.3.1      
[61] quadprog_1.5-8       munsell_0.5.1        pillar_1.9.0        
[64] htmltools_0.5.8.1    Brobdingnag_1.2-9    R6_2.5.1            
[67] vroom_1.6.5          evaluate_0.24.0      lattice_0.22-6      
[70] markdown_1.13        backports_1.5.0      gridtext_0.1.5      
[73] broom_1.0.6          renv_0.17.3          rstantools_2.4.0    
[76] gridExtra_2.3        coda_0.19-4.1        nlme_3.1-166        
[79] checkmate_2.3.1      xfun_0.45            pkgconfig_2.0.3     </code></pre>
</div>
</div>
</section>
<section id="citing-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="citing-r-packages">Citing R packages</h2>
<p>The following packages were used in this post:</p>
<ul>
<li><code>brms</code> <span class="citation" data-cites="brms">(Bürkner 2021)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(Wickham et al. 2019)</span></li>
<li><code>ggdist</code> <span class="citation" data-cites="ggdist">(Kay 2023)</span></li>
<li><code>modelr</code> <span class="citation" data-cites="modelr">(Wickham 2023)</span></li>
<li><code>tidybayes</code> <span class="citation" data-cites="tidybayes">(Kay 2024)</span></li>
</ul>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-brms" class="csl-entry">
Bürkner, Paul-Christian. 2021. <span>“Bayesian Item Response Modeling in <span>R</span> with <span class="nocase">brms</span> and <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 100 (5): 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>.
</div>
<div id="ref-ggdist" class="csl-entry">
Kay, Matthew. 2023. <span>“Ggdist: Visualizations of Distributions and Uncertainty in the Grammar of Graphics.”</span> <a href="https://doi.org/10.31219/osf.io/2gsz6">https://doi.org/10.31219/osf.io/2gsz6</a>.
</div>
<div id="ref-tidybayes" class="csl-entry">
———. 2024. <em><span class="nocase">tidybayes</span>: Tidy Data and Geoms for <span>Bayesian</span> Models</em>. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>.
</div>
<div id="ref-modelr" class="csl-entry">
Wickham, Hadley. 2023. <em>Modelr: Modelling Functions That Work with the Pipe</em>. <a href="https://CRAN.R-project.org/package=modelr">https://CRAN.R-project.org/package=modelr</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div></section></div> ]]></description>
  <category>Individual Participant Data</category>
  <category>Repeated Measures</category>
  <category>Meta-Analysis</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-10.html</guid>
  <pubDate>Thu, 31 Oct 2024 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Generalized Additive Models (GAMs) for Meta-Regression using brms</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-8.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Support my work&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="what-is-meta-regression" class="level2">
<h2 class="anchored" data-anchor-id="what-is-meta-regression">What is Meta-regression?</h2>
<p>Meta-regression is a modeling approach used in meta-analysis to see how effect sizes vary across studies. For example, let’s say we want to know the effect of some drug on disease remission, but the effect sizes are highly heterogenous (studies use different methods, sample from different populations, etc. and thus have different estimands). We may want to know what aspects of these studies cause differences in their resulting effects? If different studies use a different doseage amount then we may hypothesize that dose will account for some of that heterogeneity in effects. Doseage is what we would call a <strong>moderator</strong> of the effect size (moderator is analogous to a predictor in a traditional regression). Meta-regression is like any regression model with the only difference that the data points represent entire studies and that studies are weighted such that more precise studies (i.e., larger sample sizes/smaller standard errors) are preferentially weighted. The regression line will estimate the <strong>conditional mean</strong> effect size.</p>
<p>Let’s visualize this example by running a meta-regression and creating a bubble plot (a scatter plot, but the data points are sized relative to the precision of the study). The effect size is the log risk ratio between treatment and control groups,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cln%20RR%20=%20%5Cln%20%5Cfrac%7Bp_T%7D%7Bp_C%7D,%0A"> where <img src="https://latex.codecogs.com/png.latex?p_T"> and <img src="https://latex.codecogs.com/png.latex?p_C"> are the proportions of individuals in remission within the treatment and control group, respectively. We will then see how the doseage moderates the <img src="https://latex.codecogs.com/png.latex?%5Cln%20RR"> across studies. In R, we can use the <code>metafor</code> <span class="citation" data-cites="metafor">(Viechtbauer 2010)</span> package to fit a meta-regression.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(metafor)</span>
<span id="cb1-2"></span>
<span id="cb1-3">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">escalc</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RR"</span>,</span>
<span id="cb1-4">              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data set loaded in from metafor package</span></span>
<span id="cb1-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat.viechtbauer2021,</span>
<span id="cb1-6">              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># treatment/control number of people in remission</span></span>
<span id="cb1-7">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ai =</span> xTi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ci =</span> xCi,</span>
<span id="cb1-8">              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># treatment/control group sample size in</span></span>
<span id="cb1-9">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n1 =</span> nTi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n2 =</span> nCi,</span>
<span id="cb1-10">              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># label effect size and sampling variance (se^2)</span></span>
<span id="cb1-11">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lnRR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>))</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fit model</span></span>
<span id="cb1-14">mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(lnRR <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> dose, </span>
<span id="cb1-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb1-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot model</span></span>
<span id="cb1-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regplot</span>(mdl,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">refline =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-8_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>We see a very strong relationship between the effect size and the dosage amount.</p>
</section>
<section id="what-would-a-meta-analytic-gam-look-like" class="level2">
<h2 class="anchored" data-anchor-id="what-would-a-meta-analytic-gam-look-like">What would a meta-analytic GAM look like?</h2>
<p><strong>This brief intro section is a sort of a meta-analytic adaptation of a <a href="https://m-clark.github.io/generalized-additive-models/building_gam.html#what-is-a-gam">section</a> of Michael Clark’s online text “Generalized Additive Models”.</strong></p>
<p>In our example, we used a linear meta-regression so let us define a simple linear meta-regression model mathematically. An observed (arbitrary) effect size <img src="https://latex.codecogs.com/png.latex?d_i"> from study <img src="https://latex.codecogs.com/png.latex?i"> is expressed as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad_i%20=%20%5Cunderset%7B_%5Ctextrm%7Bintercept%7D%7D%7Bb_0%7D%20+%20%5Coverset%7B%5E%5Ctextrm%7Bmoderator%20effect%7D%7D%7Bb_1M_i%7D%20+%20%5Cunderset%7B_%5Ctextrm%7Btrue%20effect%20variability%7D%7D%7Bu_i%7D%20+%20%5Coverset%7B%5E%5Ctextrm%7Bsampling%20error%7D%7D%7B%5Cvarepsilon_i%7D.%0A"> The first three terms in the equation is what defines the true effect size <img src="https://latex.codecogs.com/png.latex?%5Cdelta_i"> for study <img src="https://latex.codecogs.com/png.latex?i"> and the last term denotes sampling error which is what distinguishes the observed effect size <img src="https://latex.codecogs.com/png.latex?d_i"> from the true effect size <img src="https://latex.codecogs.com/png.latex?%5Cdelta_i">. The true effect size is conditionally distributed as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20%5Cmid%20M_i%20%5Csim%20%5Cmathcal%7BN%7D%5Cleft(b_0%20+%20b_1M_i%5C,%20,%5C,%20%5Ctau%5E2%5Cright)%0A"> Where <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2"> is the residual variance in true effects (i.e., <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2%20=%20%5Cmathrm%7Bvar%7D(u_i)">). We can see that the conditional expectation of true effects is a linear function of the moderator variable <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Cdelta_i%20%5Cmid%20M%5D%20=%20b_0%20+%20b_1M_i">. But we don’t have to model the conditional mean as linear. If the data appears non-linear we can instead model it as some smooth function <img src="https://latex.codecogs.com/png.latex?f"> such that the conditional mean has some non-linear functional form,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20%5Cmid%20M_i%20%5Csim%20%5Cmathcal%7BN%7D%5Cleft(f(M_i),%5C,%20%5Ctau%5E2%5Cright).%0A"></p>
<p>For GAMs we elect to choose a space of functions (e.g., cubic splines) called a <strong>basis</strong>. A function within the function space can be expressed as a linear combination of basis functions. Essentially, we want to estimate this “big” function with with a series of known “smaller” functions. For our case, the function <img src="https://latex.codecogs.com/png.latex?f(M_i)"> can be expressed as, <img src="https://latex.codecogs.com/png.latex?f(M_i)%20=%20%5Csum%5Em_%7Bq=1%7D%20b_q%5Cxi_q(M_i)">, where <img src="https://latex.codecogs.com/png.latex?%5Cxi_q"> are basis functions. Therefore the conditional distribution of true effects is now given by,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20%5Cmid%20M_i%20%5Csim%20%5Cmathcal%7BN%7D%5Cleft(%5Csum%5Em_%7Bq=1%7D%20b_q%5Cxi_q(M_i),%5C,%20%5Ctau%5E2%5Cright).%0A"></p>
<p>The conditional expectation of true effects now can have a lot of flexibility. Note that we do not want to try to interpret the regression coefficients <img src="https://latex.codecogs.com/png.latex?b_q"> of those smaller basis functions, instead we want to interpret the bigger function which is estimating the conditional mean of true effects. To estimate the conditional expectation, GAMs utilize <strong>penalized splines</strong> which penalizes the function for being too “wiggly” so as to maintain a parsimonious model. The number of knots (i.e., the joints/abscissa of the “big” function) also does not have to be set manually like they do in other spline models.</p>
</section>
<section id="loading-in-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-in-packages">Loading in packages</h2>
<p>We will need the following packages before we begin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(brms)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mgcv)</span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidybayes)</span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modelr)</span>
<span id="cb2-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span></code></pre></div>
</div>
</section>
<section id="non-linear-data" class="level2">
<h2 class="anchored" data-anchor-id="non-linear-data">Non-linear Data</h2>
<p>We can use some made up non-linear data created by Wolfgang Viechtbauer in his <a href="https://www.metafor-project.org/doku.php/tips:non_linear_meta_regression">tutorial</a> on spline meta-regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">structure</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># effect size data</span></span>
<span id="cb3-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.54</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.29</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.66</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.18</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.23</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.73</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.38</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.19</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.31</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.41</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.32</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.22</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.24</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.17</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.29</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.07</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.03</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.16</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.07</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.64</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.66</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.76</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.91</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.62</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.29</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.34</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.21</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.07</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.21</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.71</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.11</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.78</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.04</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.93</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.77</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.47</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.04</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.42</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.24</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.53</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.73</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.98</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.43</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.64</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.09</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.06</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.36</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.97</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.28</span>), </span>
<span id="cb3-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># standard error</span></span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sei =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.018</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.042</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.031</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.022</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.016</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.013</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.066</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.043</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.092</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.009</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.018</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.034</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.015</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.155</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.004</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.124</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.048</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.006</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.134</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.022</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.004</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.043</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.071</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.006</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.128</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.156</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.058</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.044</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.098</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.154</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.117</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.013</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.055</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.034</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.152</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.022</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.134</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.038</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.119</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.145</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.037</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.123</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.124</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.081</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.026</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.018</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.039</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.062</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.012</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.132</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.138</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.065</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.013</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.101</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.051</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.011</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.018</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.012</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.059</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.111</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.073</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.047</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.007</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.055</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.019</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.104</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.056</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.006</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.094</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.009</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.008</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span> )), </span>
<span id="cb3-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># moderator values</span></span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.7</span>)), </span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">class =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data.frame"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>L))</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     yi       sei   xi
1  0.99 0.1341641  9.4
2  0.54 0.2049390  6.3
3 -0.01 0.1760682  1.9
4  1.29 0.1483240 14.5
5  0.66 0.1264911  8.4
6 -0.12 0.1140175  1.8</code></pre>
</div>
</div>
<p>The effect size is denoted with <code>yi</code>, the standard errors are denoted with <code>sei</code>, and the study-level moderator values is denoted with <code>xi</code>.</p>
</section>
<section id="constructing-the-brms-model" class="level2">
<h2 class="anchored" data-anchor-id="constructing-the-brms-model">Constructing the <code>brms</code> model</h2>
<p>Using the <code>brm</code> function in the <code>brms</code> <span class="citation" data-cites="brms">(Bürkner 2021)</span> package we can construct the meta-regression GAM model by utilizing the <code>se()</code> argument to input the standard errors of the effect sizes. Then <code>s()</code> function to tell <code>brms</code> that we are fitting a GAM. The <code>sigma=TRUE</code> function allows us to have heterogeneity, that is, the model includes a <img src="https://latex.codecogs.com/png.latex?%5Csigma"> parameter which represents the standard deviation in true effects which we previously defined as <img src="https://latex.codecogs.com/png.latex?%5Ctau">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">mdl_gam <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(yi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">se</span>(sei, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">s</span>(xi),</span>
<span id="cb5-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, </span>
<span id="cb5-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gaussian</span>(),</span>
<span id="cb5-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>,</span>
<span id="cb5-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, </span>
<span id="cb5-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>, </span>
<span id="cb5-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb5-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_gam"</span>,</span>
<span id="cb5-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file_refit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_change"</span>)</span></code></pre></div>
</div>
<p>Now let’s also construct a linear model so that we can compare the two fits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">mdl_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brm</span>(yi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">se</span>(sei, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> xi,</span>
<span id="cb6-2">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, </span>
<span id="cb6-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gaussian</span>(),</span>
<span id="cb6-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>,</span>
<span id="cb6-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, </span>
<span id="cb6-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warmup =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>, </span>
<span id="cb6-7">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chains =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model_lm"</span>,</span>
<span id="cb6-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file_refit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"on_change"</span>)</span></code></pre></div>
</div>
<p>We can plot out the models by displaying the estimates of the conditional effect size mean that are compatible with the data (denoted with the dark lines) and the conditional distribution of effect sizes (the density band with the bounds denoting the 95% prediction interval).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract conditional mean estimates for GAM</span></span>
<span id="cb7-2">gam_conditional_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_range</span>(xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sei =</span> sei) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_epred_draws</span>(mdl_gam, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract true effect size predictions to construct true effect distribution for GAM</span></span>
<span id="cb7-7">gam_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_range</span>(xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">71</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sei =</span> sei) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_predicted_draws</span>(mdl_gam, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb7-10"></span>
<span id="cb7-11"></span>
<span id="cb7-12">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_lineribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> gam_predictions, </span>
<span id="cb7-14">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .prediction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill_ramp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(.width)),</span>
<span id="cb7-15">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_ramp_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_rampbar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> gam_conditional_means, </span>
<span id="cb7-18">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> .draw),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#861d5e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> yi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>sei<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#601543"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb7-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect Size"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moderator Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GAM"</span>)</span>
<span id="cb7-27"></span>
<span id="cb7-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract conditional mean estimates for GAM</span></span>
<span id="cb7-29">lm_conditional_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_range</span>(xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sei =</span> sei) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_epred_draws</span>(mdl_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb7-32"></span>
<span id="cb7-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract true effect size predictions to construct true effect distribution for GAM</span></span>
<span id="cb7-34">lm_predictions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_range</span>(xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sei =</span> sei) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_predicted_draws</span>(mdl_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb7-37"></span>
<span id="cb7-38"></span>
<span id="cb7-39">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_ribbon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> lm_predictions, </span>
<span id="cb7-41">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .prediction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill_ramp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(.width)),</span>
<span id="cb7-42">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_ramp_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guide =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_rampbar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> lm_conditional_means, </span>
<span id="cb7-45">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> .epred, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> .draw),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#861d5e"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> yi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>sei<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#601543"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_ggdist</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#ED5C9B"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb7-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Effect Size"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Moderator Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GAM"</span>)</span>
<span id="cb7-54"></span>
<span id="cb7-55"></span>
<span id="cb7-56">cowplot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(p1,p2,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-8_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predictive-check" class="level2">
<h2 class="anchored" data-anchor-id="predictive-check">Predictive Check</h2>
<p>The predictive check of the GAM model captures the data better than the linear model in this data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">pp1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pp_check</span>(mdl_gam, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GAM"</span>)</span>
<span id="cb8-4">pp2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pp_check</span>(mdl_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ndraws =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggtitle</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Linear Model"</span>)</span>
<span id="cb8-7"></span>
<span id="cb8-8"></span>
<span id="cb8-9">cowplot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_grid</span>(pp1,pp2)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-8_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] ggdist_3.3.2        modelr_0.1.11       tidybayes_3.0.7    
 [4] mgcv_1.9-1          nlme_3.1-166        brms_2.22.0        
 [7] Rcpp_1.0.12         lubridate_1.9.3     forcats_1.0.0      
[10] stringr_1.5.1       dplyr_1.1.4         purrr_1.0.2        
[13] readr_2.1.5         tidyr_1.3.1         tibble_3.2.1       
[16] ggplot2_3.5.1       tidyverse_2.0.0     metafor_4.6-0      
[19] numDeriv_2016.8-1.1 metadat_1.2-0       Matrix_1.7-1       

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1     svUnit_1.0.6         viridisLite_0.4.2   
 [4] farver_2.1.2         loo_2.8.0            fastmap_1.2.0       
 [7] tensorA_0.36.2.1     mathjaxr_1.6-0       digest_0.6.36       
[10] timechange_0.3.0     lifecycle_1.0.4      StanHeaders_2.32.10 
[13] magrittr_2.0.3       posterior_1.6.0      compiler_4.4.2      
[16] rlang_1.1.4          tools_4.4.2          utf8_1.2.4          
[19] yaml_2.3.8           knitr_1.47           labeling_0.4.3      
[22] bridgesampling_1.1-2 htmlwidgets_1.6.4    pkgbuild_1.4.4      
[25] plyr_1.8.9           abind_1.4-8          withr_3.0.0         
[28] grid_4.4.2           stats4_4.4.2         fansi_1.0.6         
[31] colorspace_2.1-0     inline_0.3.19        scales_1.3.0        
[34] cli_3.6.3            mvtnorm_1.3-1        rmarkdown_2.27      
[37] generics_0.1.3       RcppParallel_5.1.9   rstudioapi_0.16.0   
[40] reshape2_1.4.4       tzdb_0.4.0           rstan_2.32.6        
[43] splines_4.4.2        bayesplot_1.11.1     parallel_4.4.2      
[46] matrixStats_1.4.1    vctrs_0.6.5          jsonlite_1.8.8      
[49] hms_1.1.3            arrayhelpers_1.1-0   glue_1.7.0          
[52] codetools_0.2-20     cowplot_1.1.3        distributional_0.4.0
[55] stringi_1.8.4        gtable_0.3.5         QuickJSR_1.3.1      
[58] munsell_0.5.1        pillar_1.9.0         htmltools_0.5.8.1   
[61] Brobdingnag_1.2-9    R6_2.5.1             evaluate_0.24.0     
[64] lattice_0.22-6       backports_1.5.0      broom_1.0.6         
[67] renv_0.17.3          rstantools_2.4.0     coda_0.19-4.1       
[70] gridExtra_2.3        checkmate_2.3.1      xfun_0.45           
[73] pkgconfig_2.0.3     </code></pre>
</div>
</div>
</section>
<section id="citing-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="citing-r-packages">Citing R packages</h2>
<p>The following packages were used in this post:</p>
<ul>
<li><code>brms</code> <span class="citation" data-cites="brms">(Bürkner 2021)</span></li>
<li><code>mgcv</code> <span class="citation" data-cites="splines">(R Core Team 2024)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(Wickham et al. 2019)</span></li>
<li><code>ggdist</code> <span class="citation" data-cites="ggdist">(Kay 2023)</span></li>
<li><code>modelr</code> <span class="citation" data-cites="modelr">(Wickham 2023)</span></li>
<li><code>tidybayes</code> <span class="citation" data-cites="tidybayes">(Kay 2024)</span></li>
</ul>
<p><strong>Thanks to Isabella R. Ghement, Stephen J. Wild, and Solomon Kurz for their advice and feedback on this post.</strong></p>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-brms" class="csl-entry">
Bürkner, Paul-Christian. 2021. <span>“Bayesian Item Response Modeling in <span>R</span> with <span class="nocase">brms</span> and <span>Stan</span>.”</span> <em>Journal of Statistical Software</em> 100 (5): 1–54. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>.
</div>
<div id="ref-ggdist" class="csl-entry">
Kay, Matthew. 2023. <span>“Ggdist: Visualizations of Distributions and Uncertainty in the Grammar of Graphics.”</span> <a href="https://doi.org/10.31219/osf.io/2gsz6">https://doi.org/10.31219/osf.io/2gsz6</a>.
</div>
<div id="ref-tidybayes" class="csl-entry">
———. 2024. <em><span class="nocase">tidybayes</span>: Tidy Data and Geoms for <span>Bayesian</span> Models</em>. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>.
</div>
<div id="ref-splines" class="csl-entry">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-metafor" class="csl-entry">
Viechtbauer, Wolfgang. 2010. <span>“Conducting Meta-Analyses in <span>R</span> with the <span class="nocase">metafor</span> Package.”</span> <em>Journal of Statistical Software</em> 36 (3): 1–48. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-modelr" class="csl-entry">
Wickham, Hadley. 2023. <em>Modelr: Modelling Functions That Work with the Pipe</em>. <a href="https://CRAN.R-project.org/package=modelr">https://CRAN.R-project.org/package=modelr</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div></section></div> ]]></description>
  <category>Generalized Additive Models</category>
  <category>Meta-regression</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-8.html</guid>
  <pubDate>Tue, 24 Sep 2024 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>A Response to Jonathan Haidt’s Response</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-7.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Support my work&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="establishing-my-motivation" class="level2">
<h2 class="anchored" data-anchor-id="establishing-my-motivation">Establishing my motivation</h2>
<p>Although my original post made it seem that I have some prior opinion that social media effects mental health. In reality, I actually think that social media probably <strong><em>does</em></strong> have an average negative effect on mental health. I also probably agree that the RCTs in this meta-analysis probably won’t find any convincing causal estimates. If Rausch and Haidt’s (R&amp;H) made the argument that there is a causal effect, but the RCTs won’t capture then I would have never made my original post. What I know is meta-analysis, not the literature on social media use and mental health. I was motivated to write the original post because of the clear statistical malpractice employed in R&amp;H’s re-analysis. I have no desire to prove or disprove whether social media is actually detrimental to mental health, but I do have a desire to combat the spread of misleading analyses and poor statistical practice.</p>
<p>Also, to those absurd comments and emails out there saying that I am somehow working for big Pharma, social media companies, the government, or profiting on some misinformation campaign: I am literally a graduate student who lives with my parents to save money on rent (you can help me out by buying me a <a href="https://www.buymeacoffee.com/matthewbjane">coffee</a>). I do this because I truly believe in the fight for a rigorous, open, and transparent science. I have been very critical of how academia operates and I hope to make some positive change to that end. Anyways, on to the post…</p>
</section>
<section id="where-could-i-have-been-better" class="level2">
<h2 class="anchored" data-anchor-id="where-could-i-have-been-better">Where could I have been better?</h2>
<p>The best criticisms of my blog outside of R&amp;H’s criticisms seemed to have been that length weeks should have been log scaled (pulling in that 10 week intervention) and also I should have fit some non-linear model. I think these are completely valid points and I will conduct that analysis in this blog post.</p>
<p>R&amp;H responded to one of my last analyses in the post (regressing the effect size on length of intervention) and said the following:</p>
<blockquote class="blockquote">
<p>a blog post by Matthew Jané used Ferguson’s numbers and concluded that there is no relationship between the duration of reduction and the effect size.</p>
</blockquote>
<p>This is all true (with the slight quibble that I said “little/no” relationship) and I should have been clearer about the assumptions underlying my claim. In my original post I said this:</p>
<blockquote class="blockquote">
<p>Okay so as it turns out there appears to be little/no effect of the length of the intervention on the effect size.</p>
</blockquote>
<p>I really should have said this:</p>
<blockquote class="blockquote">
<p><span style="color:red;"><strong><em>Given the proposed model and the data,</em></strong></span> there appears to be little/no effect of the length of the intervention on the effect size.</p>
</blockquote>
<p>Usually that does not need to be said considering the model was defined, but it is important nonetheless, since if I were to choose a different model it is possible we could have see a relationship between the two variables.</p>
</section>
<section id="in-response-to-the-community-note-on-haidts-tweet" class="level2">
<h2 class="anchored" data-anchor-id="in-response-to-the-community-note-on-haidts-tweet">In Response to the Community Note on Haidt’s Tweet</h2>
<p>A community note (that I did not write) was attached to Haidt’s tweet containing the R&amp;H re-analysis. It has since disappeared, but here was the content of the note:</p>
<blockquote class="blockquote">
<p>As many statistics experts have pointed out, this analysis is incorrect. If done correctly, the analysis shows that reducing social media has no effect. <em>*then it links to my blog post as a source*</em></p>
</blockquote>
<p>Although the first sentence I believe is accurate, the <strong>second sentence is not true and I did not state that in the original post</strong>. Therefore I am okay that the community note was taken down for whatever reason. Then promptly, a better and even more recent community note was posted that read,</p>
<blockquote class="blockquote">
<p>The reanalysis doesn’t use an appropriate statistical model. It simply calculates an unweighted average across different studies, doesn’t provide confidence intervals, and misinterprets the evidence</p>
</blockquote>
<p>All these points are unequivocally true. However, Haidt then posted the following tweet,</p>
<p></p><div id="tweet-60114"></div><script>tweet=<!DOCTYPE html>
<html lang="en" class="dog">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X / ?</title>
    <meta name="version" content="1">
    <link href="https://abs.twimg.com/favicons/twitter.3.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="stylesheet" href="https://abs.twimg.com/errors/fullscreen_errors-047ca1475a6efac7c9c89a9ff92b7a20.css">
  </head>
  <body dir="auto">
    <div class="top">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1519 200">
        <defs/>
        <path d="M708 103l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9368 9368 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h11l10-6 6 3 9-1 4-1 1 1 1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a38 38 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
        <path d="M-36 193l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9328 9328 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h9a6 6 0 002 0l10-6 6 3 9-1 4-1a6 6 0 001 1l1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a37 37 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
      </svg>
    </div>
    <div class="container">
      <div class="content">
        <a href="https://twitter.com" title="X logo">
          <svg viewBox="0 0 24 24" aria-hidden="true" class="x-logo"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></g></svg>
        </a>
        <h1 id="header">Nothing to see here</h1>
        <p id="description">Looks like this page doesn’t exist. Here’s a picture of a poodle sitting in a chair for your trouble.</p>

          <a id="button_search" href="/" class="button">Looking for this?</a>

      </div>
      <img id="image" src="https://abs.twimg.com/errors/ErrorState_NotFound.png" alt="A primped poodle with a bow in its hair sitting in a chair like a human.">
      <div class="footer">
        <ul>
          <li><a href="https://twitter.com/" id="footer_home">Home</a></li>
          <li><a href="https://status.twitterstat.us/" id="footer_status">Status</a></li>
          <li><a href="https://twitter.com/tos" id="footer_tos">Terms of Service</a></li>
          <li><a href="https://twitter.com/privacy" id="footer_privacy">Privacy Policy</a></li>
          <li><a href="https://support.twitter.com/articles/20170514" id="footer_cookie">Cookie Policy</a></li>
          <li><a href="https://legal.twitter.com/imprint" id="footer_imprint">Imprint</a></li>
          <li><a href="https://business.twitter.com/en/help/troubleshooting/how-twitter-ads-work.html" id="footer_ads">Ads info</a></li>
          <li dir="ltr">&copy; X Corp. <span id="copyright-year">&emsp;&emsp;&emsp;&emsp;</span></li>
        </ul>
      </div>
    </div>
  </body>
  <script src="https://abs.twimg.com/errors/404-8651f633fd193e0b546010676a4fac06.js"></script>

;document.getElementById("tweet-60114").innerHTML = tweet["html"];<p></p>
<p>This tweet seemed to get his followers to rate the community note as unhelpful and thus it was taken down again. Of course, it is difficult to maintain a community note with Haidt’s large following. So I guess we will have to treat these blog posts as a much more detailed community note.</p>
</section>
<section id="rhs-analysis-was-unequivocally-a-meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="rhs-analysis-was-unequivocally-a-meta-analysis">R&amp;H’s analysis was unequivocally a meta-analysis</h2>
<p>In a tweet by Haidt, he pointed out that R&amp;H’s re-analysis should not be considered a meta-analysis:</p>
<blockquote class="blockquote">
<p>I think it was a mistake to treat our essay as a meta-analysis</p>
</blockquote>
<p>The reason I treated R&amp;H’s re-analysis as a meta-analysis is because it is, by definition, a meta-analysis. Let me be clear, R&amp;H’s analysis consisted of <strong>1) averaging results across studies</strong> and <strong>2) counting up positive, negative, and null effects</strong>, both of which are just different obsolete and unacceptable methods of meta-analysis (the latter is commonly referred to as a vote-counting meta-analysis). If you are unconvinced, here is the definition of a meta-analysis from the <a href="https://training.cochrane.org/handbook/current/chapter-10">Cochrane handbook</a>:</p>
<blockquote class="blockquote">
<p>Meta-analysis is the statistical combination of results from two or more separate studies.</p>
</blockquote>
<p>If you simply calculate an average effect size across studies, you have conducted a meta-analysis. If you tally up the number of positive and negative results, you have conducted a meta-analysis. Every table in R&amp;H’s article is literally displaying a meta-analysis, whether that was their intent or not.</p>
<p>On top of all of the fundamental flaws in their analysis, R&amp;H also based the following claim on their meta-analytic results:</p>
<blockquote class="blockquote">
<p>These results clearly indicate that multi-week social media reduction experiments improve some aspects of well-being</p>
</blockquote>
<p>Their results absolutely do not <em>clearly</em> indicate this. This is an extremely misleading conclusion that is based on a completely inappropriate analysis.</p>
<p><strong>I recommend that R&amp;H remove the tables with meta-analytic results and all the conclusions/claims associated with those results. Adding a postscript, a preface, and changing the title does not fix this.</strong></p>
</section>
<section id="errors-in-effect-sizes-and-sample-sizes" class="level2">
<h2 class="anchored" data-anchor-id="errors-in-effect-sizes-and-sample-sizes">Errors in Effect Sizes and Sample Sizes</h2>
<p>Haidt also claims that there are errors in the effect sizes and sample sizes in <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>’s meta-analysis:</p>
<blockquote class="blockquote">
<p>Our post was about how there are so many errors in the Ferguson meta, including errors in sample sizes and effect sizes, that we can’t yet do weighting or confidence intervals.</p>
</blockquote>
<p>Yet R&amp;H still conduct their re-analysis on those effect sizes. <strong>If the data is untrustworthy why conduct any analysis in the first place?</strong> Why is it more justifiable to compute unweighted average effects without any indicator of variability from that data base? If they believe that the data is untrustworthy, why conduct the analysis at all? If we decide to conduct an analysis, we must do it using the appropriate statistical techniques. <strong>Like I said previously, if R&amp;H retracted their re-analysis and instead argued that these RCTs do not properly capture the causal effects of social media on mental health, I would probably agree with them.</strong></p>
<p>I do not have the time to double check all the effect sizes of Ferguson’s meta-analysis. I analyzed them at face value which is exactly what R&amp;H did in their re-analyses.</p>
</section>
<section id="haidts-future-meta-analysis" class="level2">
<h2 class="anchored" data-anchor-id="haidts-future-meta-analysis">Haidt’s future meta-analysis</h2>
<p>Haidt has proposed that he is planning to conduct a re-do of the <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>’s meta-analysis</p>
<blockquote class="blockquote">
<p>Nonetheless, all of this is to show why we are not trying to do our own meta analysis with Ferguson’s data. In a future post we plan to do a review of the evidence from scratch so that we avoid these many problems. (It’s worth noting that we have also found five additional multi-week reduction studies, all of which find benefits to reduction, which are not in Ferguson’s meta).</p>
</blockquote>
<p><strong><em>To Jonathan Haidt</em></strong>: <strong>I would love to offer my help as a collaborator/consultant for this upcoming project so that we can establish a systematic, transparent, reproducible, and rigorous review, and meta-analysis plan. I also know many awesome and knowledgeable meta-analysts that I would be happy to recommend to you. You can email me at matthew.jane@uconn.edu</strong></p>
<p>Constructing a systematic, rigorous, transparent, and fully reproducible meta-analysis is not only difficult, it is also exceedingly rare.</p>
</section>
<section id="controversy-surrounding-the-study-by-collis-and-egger-2022" class="level2">
<h2 class="anchored" data-anchor-id="controversy-surrounding-the-study-by-collis-and-egger-2022">Controversy surrounding the study by Collis and Egger (2022)</h2>
<p>R&amp;H’s primary critique of my analysis was that Collis and Egger’s (2022) study shouldn’t be included because the manipulation check failed. From my reading of the paper, the treatment group did demonstrate lower screen time for facebook, instagram, and snapchat, however <em>higher</em> for instant messaging apps, news/media, gaming, as well as overall screen time. R&amp;H mention WhatsApp as one of the primary apps that people replaced social media with. It does not seem that people really consider instant messaging like WhatsApp a form of social media (see poll results below):</p>
<p></p><div id="tweet-66985"></div><script>tweet=<!DOCTYPE html>
<html lang="en" class="dog">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X / ?</title>
    <meta name="version" content="1">
    <link href="https://abs.twimg.com/favicons/twitter.3.ico" rel="shortcut icon" type="image/x-icon">
    <link rel="stylesheet" href="https://abs.twimg.com/errors/fullscreen_errors-047ca1475a6efac7c9c89a9ff92b7a20.css">
  </head>
  <body dir="auto">
    <div class="top">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1519 200">
        <defs/>
        <path d="M708 103l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9368 9368 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h11l10-6 6 3 9-1 4-1 1 1 1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a38 38 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
        <path d="M-36 193l9-5 13 1 2-2 5 1h8l1-1 42-5h7l7 3v1l12-2a9328 9328 0 0129-6l2-5 12 1 6-2 3 1 2 1v-2l13-2v1l4 2 7-1h1l17-3 1 2 4-1 18-7 3-1 4-1h9l13-1 1-4 3-2 13 1v2l22-2 10-3h6l10 5 16-5 15-3 2-1 8-4 6-2 12-1 7-2 8 5 7 1 22-9h7l5-1v-1l25-3 1 2 5 2v1h11l2 1 8-4h3l-1 1h9a6 6 0 002 0l10-6 6 3 9-1 4-1a6 6 0 001 1l1-2 6-1 1-1 10-2h2l7-5v1h4l3-1c11 0 23 2 34-3 2-2 7 0 10 0l12 1 4 1 9 2 12-1 11-3 11 1h4l10-6 17 1 2 1c9 2 19-3 22-11l1-1 9 1 15-5c3-1 9 4 9-5 5 0 5 3 5 7l2 3 4-1 4-2 9-4 3-3h3l8-4 6-3 26 2 7-4h18l7 1c10 3 13-6 17-12l8 4 3-1 14-3 15-2a37 37 0 01-5-1l-8-4 7-8 8-4-10-136-922 71 16 205z"/>
      </svg>
    </div>
    <div class="container">
      <div class="content">
        <a href="https://twitter.com" title="X logo">
          <svg viewBox="0 0 24 24" aria-hidden="true" class="x-logo"><g><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></g></svg>
        </a>
        <h1 id="header">Nothing to see here</h1>
        <p id="description">Looks like this page doesn’t exist. Here’s a picture of a poodle sitting in a chair for your trouble.</p>

          <a id="button_search" href="/" class="button">Looking for this?</a>

      </div>
      <img id="image" src="https://abs.twimg.com/errors/ErrorState_NotFound.png" alt="A primped poodle with a bow in its hair sitting in a chair like a human.">
      <div class="footer">
        <ul>
          <li><a href="https://twitter.com/" id="footer_home">Home</a></li>
          <li><a href="https://status.twitterstat.us/" id="footer_status">Status</a></li>
          <li><a href="https://twitter.com/tos" id="footer_tos">Terms of Service</a></li>
          <li><a href="https://twitter.com/privacy" id="footer_privacy">Privacy Policy</a></li>
          <li><a href="https://support.twitter.com/articles/20170514" id="footer_cookie">Cookie Policy</a></li>
          <li><a href="https://legal.twitter.com/imprint" id="footer_imprint">Imprint</a></li>
          <li><a href="https://business.twitter.com/en/help/troubleshooting/how-twitter-ads-work.html" id="footer_ads">Ads info</a></li>
          <li dir="ltr">&copy; X Corp. <span id="copyright-year">&emsp;&emsp;&emsp;&emsp;</span></li>
        </ul>
      </div>
    </div>
  </body>
  <script src="https://abs.twimg.com/errors/404-8651f633fd193e0b546010676a4fac06.js"></script>

;document.getElementById("tweet-66985").innerHTML = tweet["html"];<p></p>
<p>It does not seem clear to me that this is a failed manipulation check, especially considering total digital screen time is not the target intervention variable. R&amp;H also mention there is no evidence that other social media apps were used:</p>
<blockquote class="blockquote">
<p>In addition, there is no evidence that participants reduced their use of other social media platforms such as TikTok, YouTube, Twitter, and Reddit (all of which were widely used by college students in 2019).</p>
</blockquote>
<p>However that is true for a lot of the other studies in this meta-analysis where screen time wasn’t even monitored or monitored with self-report rather than more objective measures. I do not think we should punish one study for being transparent and providing a manipulation check.</p>
<p>Although I am against the exclusion of Collis and Eggers (2022) in principle, I will nevertheless fit the regression model with and without it.</p>
</section>
<section id="setting-up-the-code" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-code">Setting up the code</h2>
<p>In this section we are just going to run the code we went over in the last blog post (see <a href="https://matthewbjane.com/blog-posts/blog-post-6.html">here</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load in packages</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mgcv)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(splines)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(osfr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(metafor)</span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psychmeta)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># download data from OSF repo</span></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xlsx</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MatthewBJane.nosync/blog-posts/Best Practices Coding Experiments.xlsx"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 16
   Citation       block     n      d Standardized Outcome…¹ `Validated Outcomes`
   &lt;chr&gt;          &lt;lgl&gt; &lt;dbl&gt;  &lt;dbl&gt;                  &lt;dbl&gt;                &lt;dbl&gt;
 1 Alcott 2020    NA     1661  0.09                       1                    1
 2 Brailovskaia … NA      286  0.154                      1                    1
 3 Brailovskaia … NA      322  0                          1                    1
 4 Collins and E… NA      121 -0.138                      1                    1
 5 Deters &amp; Mehl… NA       86 -0.207                      1                    1
 6 Faulhaber et … NA      230  0.484                      1                    1
 7 Gajdics 2022   NA      235 -0.364                      1                    1
 8 Hall et al. 2… NA      130 -0.007                      1                    1
 9 Hunt 2018      NA      143  0.232                      1                    1
10 Hunt 2021      NA       88  0.374                      1                    1
# ℹ 25 more rows
# ℹ abbreviated name: ¹​`Standardized Outcomes`
# ℹ 10 more variables: `Matched Control Condition` &lt;dbl&gt;,
#   `Distractor Questionnaires` &lt;dbl&gt;, `Query hypothesis guessing` &lt;dbl&gt;,
#   Preregistration &lt;dbl&gt;, Age &lt;dbl&gt;, Year &lt;dbl&gt;, `Best Practices Total` &lt;dbl&gt;,
#   `Verified 1= yes, 2=no` &lt;dbl&gt;, `Ratio at post` &lt;dbl&gt;,
#   `Citation Bias 1=yes, 2 = no` &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load in dataset and filter out studies without data</span></span>
<span id="cb3-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Best Practices Coding Experiments.xlsx"</span>,</span>
<span id="cb3-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sheet =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(d))</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display effect size data for first 6 studies</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Citation                    n      d
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;
1 Alcott 2020              1661  0.09 
2 Brailovskaia 2020         286  0.154
3 Brailovskaia 2022         322  0    
4 Collins and Edgers 2022   121 -0.138
5 Deters &amp; Mehl 2013         86 -0.207
6 Faulhaber et al., 2023    230  0.484</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute sampling variance</span></span>
<span id="cb5-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var_error_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d =</span> d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n1 =</span> n))</span>
<span id="cb5-4"></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display updated dataset</span></span>
<span id="cb5-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Citation                    n      d       v
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 Alcott 2020              1661  0.09  0.00241
2 Brailovskaia 2020         286  0.154 0.0141 
3 Brailovskaia 2022         322  0     0.0125 
4 Collins and Edgers 2022   121 -0.138 0.0337 
5 Deters &amp; Mehl 2013         86 -0.207 0.0479 
6 Faulhaber et al., 2023    230  0.484 0.0181 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_weeks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alcott 2020</span></span>
<span id="cb7-3">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2020</span></span>
<span id="cb7-4">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2022</span></span>
<span id="cb7-5">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collins and Edgers 2022</span></span>
<span id="cb7-6">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Deters &amp; Mehl 2013</span></span>
<span id="cb7-7">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Faulhaber et al., 2023</span></span>
<span id="cb7-8">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gajdics 2022</span></span>
<span id="cb7-9">                          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hall et al. 2021</span></span>
<span id="cb7-10">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2018</span></span>
<span id="cb7-11">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2021</span></span>
<span id="cb7-12">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kleefeld dissertation</span></span>
<span id="cb7-13">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lambert 2022</span></span>
<span id="cb7-14">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lepp 2022</span></span>
<span id="cb7-15">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mahalingham 2023</span></span>
<span id="cb7-16">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mitev 2021</span></span>
<span id="cb7-17">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ozimek 2020</span></span>
<span id="cb7-18">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Przybylski 2021</span></span>
<span id="cb7-19">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sagioglou 2014 study 2"</span></span>
<span id="cb7-20">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tartaglia</span></span>
<span id="cb7-21">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2021</span></span>
<span id="cb7-22">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2023</span></span>
<span id="cb7-23">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tromholt 2016</span></span>
<span id="cb7-24">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valley2019</span></span>
<span id="cb7-25">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># van wezel 2021</span></span>
<span id="cb7-26">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vanman 2018</span></span>
<span id="cb7-27">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ward 2017</span></span>
<span id="cb7-28">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Yuen et al., 2019</span></span>
<span id="cb7-29">  ))</span></code></pre></div>
</div>
</section>
<section id="non-linear-model-with-and-without-collis-eggers-2022" class="level2">
<h2 class="anchored" data-anchor-id="non-linear-model-with-and-without-collis-eggers-2022">Non-linear model with and without Collis &amp; Eggers (2022)</h2>
<p>In my blog post, I regressed the effect size on length of the intervention using a linear meta-regression which estimates the conditional mean effect size with a straight line. I have had a number of people request that weeks should be logged (which will pull in that Collis and Egger study) and fit a non-linear basis spline to the effects. I totally agree with this approach. Essentially we are modeling the conditional mean of the effect size as a non-linear function of the length of weeks. This will help account for the withdrawal effect that R&amp;H had mentioned.</p>
<p>Let’s first fit the model with the Collis and Egger (2022) included in the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">nu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># model with basis spline over log(weeks)</span></span>
<span id="cb8-4">mdl_weeks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(length_weeks), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> nu),</span>
<span id="cb8-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb8-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb8-7">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb8-8">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 7 studies with NAs omitted from model fitting.</code></pre>
</div>
</div>
<p>The output of the model will be difficult to interpret so we will go ahead and plot it out with the confidence and prediction intervals.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we kind of would have expected, you see an initial increase in the conditional mean and then a slow fall over time. Still there is a lot of variability both in the true effects (prediction interval) and in the conditional mean effect (confidence interval) so it is difficult to say anything here with much confidence. Now we can construct the same model with Collis and Eggers (2022) removed from the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">dat_no_CollisEggers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Citation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Collins and Edgers 2022"</span>)</span>
<span id="cb11-3"></span>
<span id="cb11-4">nu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb11-5">mdl_weeks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(length_weeks), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> nu),</span>
<span id="cb11-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb11-7">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat_no_CollisEggers,</span>
<span id="cb11-8">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb11-9">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 7 studies with NAs omitted from model fitting.</code></pre>
</div>
</div>
<p>Like we did for the last one, we can plot out the same model without the Collis and Egger (2022) study:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-7_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Surprisingly, even without Collis and Egger’s study there really isn’t a whole lot we can say here with confidence. It does not really even appear is much different than it is with Collis and Eggers (2022) study included. In fact, with the predictions (conditional means) plotted side by side they appear almost identical:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-7_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Model predictions (conditional mean of true effects) and confidence intervals for the model including Collis &amp; Egger and the model without.</figcaption>
</figure>
</div>
</div>
</div>
<section id="a-note-on-effect-dependency" class="level3">
<h3 class="anchored" data-anchor-id="a-note-on-effect-dependency">A note on effect dependency</h3>
<p>The confidence and prediction intervals are probably narrower then what it should be since some of the studies clearly come from the same lab and have similar designs. These CIs are likely the best case scenario.</p>
</section>
</section>
<section id="changing-the-two-week-cut-point-of-rhs" class="level2">
<h2 class="anchored" data-anchor-id="changing-the-two-week-cut-point-of-rhs">Changing the two week cut-point of R&amp;H’s</h2>
<p>Brenton Wiernik suggested that I play around with the two week cut-point that R&amp;H used in their article. I understand R&amp;H had the following justification for their cut-point,</p>
<blockquote class="blockquote">
<p>Acute withdrawal symptoms typically peak after a few days, but often last for up to two weeks.</p>
</blockquote>
<p>Therefore R&amp;H selected for reduction studies that were two weeks or longer. But if withdrawal symptoms last for two weeks in many cases, then maybe we should play it safe and only select the studies that are <em>longer</em> than two weeks (<img src="https://latex.codecogs.com/png.latex?X_%5Cmathrm%7Bweeks%7D%3E2"> rather than <img src="https://latex.codecogs.com/png.latex?X_%5Cmathrm%7Bweeks%7D%5Cgeq%202">). This cut-point could have easily been argued with R&amp;H’s reasoning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">mdl_2weeks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yi =</span> d,</span>
<span id="cb13-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb13-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb13-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb13-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>,</span>
<span id="cb13-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> length_weeks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(mdl_2weeks)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0980 0.0514 -0.0448 0.2408 -0.0448 0.2408 </code></pre>
</div>
</div>
<p>After playing it safe and allowing for withdrawal symptoms to subside we see a mean effect of <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_%5Cdelta%20=%20.098%5C,%20%5B-.045,%5C,%20.241%5D">. Well seems that the average effect is quite small and about half the size of R&amp;H’s average, but maybe we can try only studies that were more than 3 weeks,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">mdl_3weeks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yi =</span> d,</span>
<span id="cb15-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb15-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb15-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb15-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>,</span>
<span id="cb15-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> length_weeks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(mdl_3weeks)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0446 0.0910 -1.1122 1.2015 -1.5739 1.6631 </code></pre>
</div>
</div>
<p>We see the mean effect of <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_%5Cdelta%20=%20.045%5C,%20%5B-1.112,%20%5C,%201.202%5D"> is even smaller with very extremely wide CIs.</p>
<p>This goes to show that arbitrary post-hoc analytic decisions can greatly impact the end result. This is just another reason why R&amp;H’s analysis was, at the very least, highly misleading.</p>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Ultimately, after re-running the model with a more sophisticated non-linear regression with and without the Collis &amp; Egger study that Haidt suggested, there not great evidence of sustained detrimental effects in these RCTs. This does not mean social media is not, on average, detrimental for mental health, it just means that these these RCTs do not appear be good evidence of that fact.</p>
<p>If I did anything incorrectly or if I did not use best practices, I take full responsibility and you can let me know by sending me a DM on twitter or emailing me at matthewbjane@gmail.com.</p>
</section>
<section id="citing-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="citing-r-packages">Citing R packages</h2>
<p>The following packages were used here:</p>
<ul>
<li><code>mgcv</code> <span class="citation" data-cites="mgcv">(Wood et al. 2016)</span></li>
<li><code>splines</code> <span class="citation" data-cites="splines">(R Core Team 2024)</span></li>
<li><code>osfr</code> <span class="citation" data-cites="osfr">(Wolen et al. 2020)</span></li>
<li><code>tidyverse</code> <span class="citation" data-cites="tidyverse">(Wickham et al. 2019)</span></li>
<li><code>metafor</code> <span class="citation" data-cites="metafor">(Viechtbauer 2010)</span></li>
<li><code>readxl</code> <span class="citation" data-cites="readxl">(Wickham and Bryan 2023)</span></li>
<li><code>psychmeta</code> <span class="citation" data-cites="psychmeta">(Dahlke and Wiernik 2019)</span></li>
<li><code>ggdist</code> <span class="citation" data-cites="ggdist">(Kay 2023)</span></li>
</ul>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-psychmeta" class="csl-entry">
Dahlke, Jeffrey A., and Brenton M. Wiernik. 2019. <span>“<span class="nocase">psychmeta</span>: An r Package for Psychometric Meta-Analysis.”</span> <em>Applied Psychological Measurement</em> 43 (5): 415–16. <a href="https://doi.org/10.1177/0146621618795933">https://doi.org/10.1177/0146621618795933</a>.
</div>
<div id="ref-ferguson2024" class="csl-entry">
Ferguson, Christopher J. 2024. <span>“Do Social Media Experiments Prove a Link with Mental Health: A Methodological and Meta-Analytic Review.”</span> <em>Psychology of Popular Media</em>, No Pagination Specified–. <a href="https://doi.org/10.1037/ppm0000541">https://doi.org/10.1037/ppm0000541</a>.
</div>
<div id="ref-ggdist" class="csl-entry">
Kay, Matthew. 2023. <span>“Ggdist: Visualizations of Distributions and Uncertainty in the Grammar of Graphics.”</span> <a href="https://doi.org/10.31219/osf.io/2gsz6">https://doi.org/10.31219/osf.io/2gsz6</a>.
</div>
<div id="ref-splines" class="csl-entry">
R Core Team. 2024. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-metafor" class="csl-entry">
Viechtbauer, Wolfgang. 2010. <span>“Conducting Meta-Analyses in <span>R</span> with the <span class="nocase">metafor</span> Package.”</span> <em>Journal of Statistical Software</em> 36 (3): 1–48. <a href="https://doi.org/10.18637/jss.v036.i03">https://doi.org/10.18637/jss.v036.i03</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry">
Wickham, Hadley, and Jennifer Bryan. 2023. <em>Readxl: Read Excel Files</em>. <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-osfr" class="csl-entry">
Wolen, Aaron R., Chris H. J. Hartgerink, Ryan Hafen, Brian G. Richards, Courtney K. Soderberg, and Timothy P. York. 2020. <span>“<span class="nocase">osfr</span>: An <span>R</span> Interface to the Open Science Framework.”</span> <em>Journal of Open Source Software</em> 5 (46): 2071. <a href="https://doi.org/10.21105/joss.02071">https://doi.org/10.21105/joss.02071</a>.
</div>
<div id="ref-mgcv" class="csl-entry">
Wood, S. N., N., Pya, and B. S"afken. 2016. <span>“Smoothing Parameter and Model Selection for General Smooth Models (with Discussion).”</span> <em>Journal of the American Statistical Association</em> 111: 1548–75.
</div>
</div></section></div> ]]></description>
  <category>meta-analysis</category>
  <category>social media</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-7.html</guid>
  <pubDate>Mon, 02 Sep 2024 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>A Statistical Interrogation of “The Case for Causality, Part 1” by Rausch and Haidt</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-6.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The article by Rausch and Haidt (R&amp;H) conducts a re-analysis of a meta-analysis by <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> on RCTs assessing the causal effect (for the sake of this post, I am avoiding any causal inference issues) of social media usage on outcomes related to well-being (e.g., life satisfaction, anxiety). However, the re-analysis conducted by R&amp;H has severe flaws. Generally speaking, if you conduct a re-analysis of any study you should be certain that the re-analysis is of higher methodological quality than the original study. That is not the case here. This blog will get a bit technical, but it is important because meta-analysis isn’t just crunching numbers across studies. There is a formal statistical model that we should adhere to to actually produce coherent and interpretable results.</p>
<p>The original meta-analysis by <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> is not without a number of flaws, but I think it accomplished what it set out to do. Notably, the meta-analysis was pre-registered, transparent, and had publicly available data. The only problem with the open data is that the statistics used to calculate the effect sizes (reported t-statistics, means, SDs, etc.) are completely missing from the database which makes reproducing it a lot harder.</p>
<p><span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>’s meta-analysis has a couple things that stood out to me as I was skimmed through it. It seems that all measures related to mental health and well-being are combined even if they are conceptually quite different (e.g., self-esteem and anxiety). When a study reported multiple different outcome measures, Ferguson decided to pool them together presumably to handle the dependency in effects. This is not an ideal strategy for two reasons, it assumes there is no heterogeneity between outcomes and it also loses specificity in the outcome. It would have been nice to see narrower bins of constructs meta-analyzed separately such as clinical anxiety/depression measures or life satisfaction/subjective well-being measures.</p>
<p>Also, the results convey a common misinterpretation of the estimate in a random effects meta-analysis. The meta-analytic estimate was communicated as follows:</p>
<blockquote class="blockquote">
<p>As can be seen the overall estimate for d across studies was 0.088, which was nonsignificant and well below the SESOI (r = .10, d = 0.21).</p>
</blockquote>
<p>What does an “overall estimate for <em>d</em>” actually mean (note: <em>d</em> is the effect size, we will talk about this in the next section)? Is there a true <em>d</em> that we are estimating by averaging the <em>d</em> values from all these studies together? No.&nbsp;A random-effects meta-analysis is estimating the <strong>mean of true effect sizes</strong>. That is, there exists a distribution of true effects and the meta-analytic estimate conveys the central tendency. Therefore, the meta-analytic estimate can <em>not</em> tell you whether the the intervention produces an effect of <em>d</em> = .088 (lets ignore the variability in this estimate for the moment), it only tells you that the effect is <em>d</em> = .088, <strong><em>on average</em></strong>. Heterogeneity in effect sizes describes how wide the distribution of true effects is. You <em>could</em> have genuine true effects that are very positive (i.e., social media use is detrimental) and very negative (i.e., social media use is beneficial) even if the meta-analytic estimate is zero. There also could be study-level characteristics that could account for this heterogeneity, for instance, studies using a particular type of experimental design or a certain outcome shows a positive effect while others don’t.</p>
<p><strong>A side note</strong>: I also came across this sentence from <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>’s meta-analysis on page 3:</p>
<blockquote class="blockquote">
<p>Given the high power of meta-analysis, almost all meta-analyses are “statistically significant.”</p>
</blockquote>
<p>I have heard this before but it is just not true, in general. In a random effects meta-analysis where you have both within and between study variance can give pretty wide confidence intervals and large p-values. This would be a reasonable statement if you are referring to a fixed effect meta-analysis with a large total sample size or a random effect meta-analysis with a ton of studies. Neither of which are true in this case.</p>
</section>
<section id="lets-get-into-it" class="level2">
<h2 class="anchored" data-anchor-id="lets-get-into-it">Let’s get into it</h2>
<p>The first part of this blog sets up a statistical meta-analysis model called a random-effects model. It is important to keep in mind that a meta-analysis is not throwing a bunch of standardized effects into a calculator and computing a mean. We need a coherent statistical model that allows us to draw meaningful inferences from the data.</p>
</section>
<section id="effect-size-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="effect-size-of-interest">Effect Size of Interest</h2>
<p>First thing we should do is to define the effect size we are using to quantify the effect of social media on well-being related outcomes. The article by <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> says they used a standardized mean difference known as a Cohen’s <em>d</em> to quantify the difference between the post-test scores in the social media using group and the non-social media using group (or some variation of that). You may think “we should be controlling for baseline differences between treatment and control groups”, well in an RCT subject’s are randomly allocated to each group so their baseline scores should be, on average, the same. We can define a (true) effect size <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> as,</p>
<p><span id="eq-effect"><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta%20=%20%5Cfrac%7B%5Cmu_%5Ctextrm%7Bsocial%7D%20-%20%5Cmu_%5Ctextrm%7Bno%20social%7D%7D%7B%5Csigma%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Ctextrm%7Bsocial%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Ctextrm%7Bno%20social%7D"> is the mean of post-test scores for the social media using group and the non-social media using group (i.e., control group), respectively. The standardizer <img src="https://latex.codecogs.com/png.latex?%5Csigma"> is the within-group standard deviation and it assumes that both the social media and non-social media group have the same standard deviation (probably a fine assumption 🤷). A sample estimator of the effect size will be denoted as <img src="https://latex.codecogs.com/png.latex?d"> and it represents the effect size we actually observe from the results of a study,</p>
<p><span id="eq-sample-effect"><img src="https://latex.codecogs.com/png.latex?%0Ad%20=%20%5Cfrac%7Bm_%5Ctextrm%7Bsocial%7D%20-%20m_%5Ctextrm%7Bno%20social%7D%7D%7Bs_%5Cmathrm%7Bpooled%7D%7D,%0A%5Ctag%7B2%7D"></span></p>
<p>where English letters denote the sample estimators of the corresponding parameters in Equation&nbsp;1. The standardizer <img src="https://latex.codecogs.com/png.latex?s_%5Cmathrm%7Bpooled%7D"> here is the pooled standard deviation. Since we only have access to the standard deviation of each group we have to pool them together to get a more precise estimate of <img src="https://latex.codecogs.com/png.latex?%5Csigma"> (again, we are assuming the standard deviations within both groups are equal in the population),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As_%5Cmathrm%7Bpooled%7D%20=%20%5Csqrt%7B%5Cfrac%7B(n_%5Ctextrm%7Bsocial%7D-1)s%5E2_%5Ctextrm%7Bsocial%7D%20+%20(n_%5Ctextrm%7Bno%20social%7D-1)s%5E2_%5Ctextrm%7Bno%20social%7D%7D%7Bn_%5Ctextrm%7Bsocial%7D%20+%20n_%5Ctextrm%7Bno%20social%7D%20-%202%7D%7D%0A"></p>
<p>I will note here, that there was no correction for small sample bias in the original meta-analysis as far as I could tell so I will not apply any correction here.</p>
</section>
<section id="statistical-model" class="level2">
<h2 class="anchored" data-anchor-id="statistical-model">Statistical Model</h2>
<p>Ultimately, the observed effect size <img src="https://latex.codecogs.com/png.latex?d"> is a sample estimate of the true effect size <img src="https://latex.codecogs.com/png.latex?%5Cdelta"> and therefore will contain error. This error is referred to as <strong>sampling error</strong> and is defined as the difference between the observed effect size and the true effect size. For a given study <img src="https://latex.codecogs.com/png.latex?i">, we can relate the observed effect size <img src="https://latex.codecogs.com/png.latex?d_i"> and the true effect size <img src="https://latex.codecogs.com/png.latex?%5Cdelta_i"> by including a sampling error term (<img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_i">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad_i%20=%20%5Cdelta_i%20+%20%5Cvarepsilon_i%0A"> where <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_i"> is literally defined as <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_i%20=%20d_i%20-%20%5Cdelta_i">. The extent to which sampling errors are obscuring our effect size can be captured by the <strong>sampling variance</strong>. We can assume that sampling errors are normally distributed and evenly distributed around zero such that, <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_i%20%5Csim%20%5Cmathcal%7BN%7D(0,v_i)"> where <img src="https://latex.codecogs.com/png.latex?v_i"> is the sampling variance for study <img src="https://latex.codecogs.com/png.latex?i">. The sampling variance for a given study is dependent on the sample size with larger samples having more precision and thus less variance. Assuming normally distributed data, the sampling variance of the standardized mean difference (Equation&nbsp;2) is calculated with the following formula,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Av%20=%20%5Cleft(%5Cfrac%7Bn-1%7D%7Bn-3%7D%5Cright)%20%5Cleft(%5Cfrac%7Bn%7D%7Bn_%5Ctextrm%7Bsocial%7Dn_%5Ctextrm%7Bno%20social%7D%7D%5Cright)%5Cleft(%20%5Cfrac%7Bd%5E2%7D%7B2n%7D%5Cright)%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?n=n_%5Ctextrm%7Bsocial%7D+n_%5Ctextrm%7Bno%20social%7D">. However unfortunately, the available dataset from <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> did not provide the sample sizes within each group so instead we will have to assume they are equal (<img src="https://latex.codecogs.com/png.latex?n_%5Ctextrm%7Bsocial%7D=n_%5Ctextrm%7Bno%20social%7D">) and use the simplified formula,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Av%20=%20%5Cleft(%5Cfrac%7Bn-1%7D%7Bn-3%7D%5Cright)%20%5Cleft(%5Cfrac%7B4%7D%7Bn%7D%5Cright)%5Cleft(1%20+%20%5Cfrac%7Bd%5E2%7D%7B8%7D%5Cright)%0A"></p>
<p>Now we might expect that any variation in effect sizes across studies is attributable to variance in random sampling errors, however this is unlikely to be the case. In reality, effect sizes tend to vary across studies above and beyond what we would expect from sampling error alone. This extra variation (known as heterogeneity) in effect sizes could be due to sampling from different populations, utilizing different methodologies, using different measures, etc.</p>
<p>Recall that we modeled an observed effect size as the sum of the true effect size for that study and sampling error <img src="https://latex.codecogs.com/png.latex?d_i%20=%20%5Cdelta_i%20+%20%5Cvarepsilon_i">. We defined the distribution of sampling errors so now we can also define the distribution of true effect sizes as <img src="https://latex.codecogs.com/png.latex?%5Cdelta_i%20%5Csim%20%5Cmathcal%7BN%7D(%5Cmu_%5Cdelta,%5Ctau%5E2)"> where <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Cdelta"> is the mean of true effect sizes across studies and <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2"> is the variance of true effect sizes (i.e., heterogeneity). Ultimately our goal in a meta-analysis is to estimate both <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Cdelta"> and <img src="https://latex.codecogs.com/png.latex?%5Ctau">. The common misinterpretation in (random-effect) meta-analyses that I described in the introduction is that a meta-analysis is estimating a single true effect size. If there is heterogeneity (<img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2%20%3E%200">) then there is a distribution of true effects that we must consider.</p>
</section>
<section id="parameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="parameter-estimation">Parameter estimation</h2>
<p>In meta-analysis we are trying to estimate particular parameters (i.e., the mean <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Cdelta"> and variance <img src="https://latex.codecogs.com/png.latex?%5Ctau"> of true effect sizes) just like any other statistical model. Simply averaging study effect sizes to obtain some “overall” effect size is not a principled statistical approach. This is why we went through the trouble of describing a random effects model in the previous section. We want to estimate the <em>mean</em> of true effect sizes (<strong>not</strong> the “overall effect size” or “the true effect size”). To estimate the mean of true effects <img src="https://latex.codecogs.com/png.latex?%5Cmu_%5Cdelta"> we can not just calculate the arithmetic mean of observed effect sizes. Instead we must use appropriate weights that take advantage of differential precision across studies. Particularly, we want to weight each study by the inverse variance,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aw_i%20=%20%5Cfrac%7B1%7D%7B%5Ctau%5E2%20+%20v_i%7D%0A"> This will preferentially weight studies with less sampling variance (i.e., larger sample sizes). Also, since <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2"> is the same for all studies, the larger <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2"> is relative to <img src="https://latex.codecogs.com/png.latex?v_i"> then the weights will become more equal across studies. We can then use these weights to estimate the mean true effect size by taking a weighted average of observed effect sizes across <img src="https://latex.codecogs.com/png.latex?k"> studies,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Cmu%7D_%5Cdelta%20=%20%5Cfrac%7B%5Csum%5Ek_%7Bi=1%7D%20w_i%20d_i%7D%7B%5Csum%5Ek_%7Bi=1%7D%20w_i%7D%0A"> where the little carrot <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Ccdot%7D"> denotes an estimate. We can also compute the 95% confidence interval of <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmu%7D_%5Cdelta"> (the set of plausible values of the actual mean that are compatible with the data) using the Hartung, Knapp, Sidik and Jonkman method (this adjusts for poor coverage rates in small <img src="https://latex.codecogs.com/png.latex?k"> meta-analyses, which is the case here),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ACI%20=%20%20%5Chat%7B%5Cmu%7D_%5Cdelta%20%5Cpm%201.96%20%5Ccdot%5Csqrt%7B%5Cfrac%7B%5Csum%5Ek_%7Bi=1%7Dw_i(d_i-%5Cmu_%5Cdelta)%5E2%7D%7B(k-1)%5Csum%5Ek_%7Bi=1%7Dw_i%7D%7D%0A"></p>
<p>The last two things we want to estimate are the variance in true effects <img src="https://latex.codecogs.com/png.latex?%5Ctau%5E2"> and what is known as a prediction interval. The variance in true effects is estimated a variety of different ways and we won’t go through all of them here. Instead we will exclusively use a restricted maximum likelihood estimator (REML) which is an iterative estimation procedure. <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> uses a maximum likelihood estimator (ML), however ML tends to under-estimate the heterogeneity. The 95% prediction interval uses the information from <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Ctau%7D"> to construct an interval that can be interpreted as the interval where 95% of true effect sizes fall.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0API%20=%20%5Chat%7B%5Cmu%7D_%5Cdelta%20%5Cpm%201.96%20%5Ccdot%5Chat%5Ctau%0A"></p>
<p>So just keep in mind that the <img src="https://latex.codecogs.com/png.latex?CI"> describes the variability in the estimate of the mean and <img src="https://latex.codecogs.com/png.latex?PI"> describes the variability in the true effects.</p>
</section>
<section id="summarizing-and-reproducing-ferguson2024" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-and-reproducing-ferguson2024">Summarizing and reproducing <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span></h2>
<p>Okay now that we have set up our model, we can now actually look at the data from the meta-analysis. Let’s load in some R packages and the dataset from the OSF repository referenced in <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load in packages</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(osfr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(metafor)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(psychmeta)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># download data from OSF repo</span></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xlsx</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Documents/MatthewBJane.nosync/blog-posts/Best Practices Coding Experiments.xlsx"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 16
   Citation       block     n      d Standardized Outcome…¹ `Validated Outcomes`
   &lt;chr&gt;          &lt;lgl&gt; &lt;dbl&gt;  &lt;dbl&gt;                  &lt;dbl&gt;                &lt;dbl&gt;
 1 Alcott 2020    NA     1661  0.09                       1                    1
 2 Brailovskaia … NA      286  0.154                      1                    1
 3 Brailovskaia … NA      322  0                          1                    1
 4 Collins and E… NA      121 -0.138                      1                    1
 5 Deters &amp; Mehl… NA       86 -0.207                      1                    1
 6 Faulhaber et … NA      230  0.484                      1                    1
 7 Gajdics 2022   NA      235 -0.364                      1                    1
 8 Hall et al. 2… NA      130 -0.007                      1                    1
 9 Hunt 2018      NA      143  0.232                      1                    1
10 Hunt 2021      NA       88  0.374                      1                    1
# ℹ 25 more rows
# ℹ abbreviated name: ¹​`Standardized Outcomes`
# ℹ 10 more variables: `Matched Control Condition` &lt;dbl&gt;,
#   `Distractor Questionnaires` &lt;dbl&gt;, `Query hypothesis guessing` &lt;dbl&gt;,
#   Preregistration &lt;dbl&gt;, Age &lt;dbl&gt;, Year &lt;dbl&gt;, `Best Practices Total` &lt;dbl&gt;,
#   `Verified 1= yes, 2=no` &lt;dbl&gt;, `Ratio at post` &lt;dbl&gt;,
#   `Citation Bias 1=yes, 2 = no` &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># load in dataset and filter out studies without data</span></span>
<span id="cb3-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Best Practices Coding Experiments.xlsx"</span>,</span>
<span id="cb3-3">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sheet =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(d))</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display effect size data for first 6 studies</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Citation                    n      d
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;
1 Alcott 2020              1661  0.09 
2 Brailovskaia 2020         286  0.154
3 Brailovskaia 2022         322  0    
4 Collins and Edgers 2022   121 -0.138
5 Deters &amp; Mehl 2013         86 -0.207
6 Faulhaber et al., 2023    230  0.484</code></pre>
</div>
</div>
<p>The data only gives us the effect size <code>d</code> and the sample size <code>n</code> for each study so we need to calculate the sampling variance. Using the <code>psychmeta</code> package we can calculate the sampling variance for each study as follows,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compute sampling variance</span></span>
<span id="cb5-2">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var_error_d</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d =</span> d, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n1 =</span> n))</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display updated dataset</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Citation                    n      d       v
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 Alcott 2020              1661  0.09  0.00241
2 Brailovskaia 2020         286  0.154 0.0141 
3 Brailovskaia 2022         322  0     0.0125 
4 Collins and Edgers 2022   121 -0.138 0.0337 
5 Deters &amp; Mehl 2013         86 -0.207 0.0479 
6 Faulhaber et al., 2023    230  0.484 0.0181 </code></pre>
</div>
</div>
<p>Now we are set up to fit a random effects model. Using the <code>metafor</code> package we can use the REML method for estimating the heterogeneity and the Hartung-Knapp-Sidik-Jonkman method for obtaining the confidence intervals and p-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yi =</span> d, </span>
<span id="cb7-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v, </span>
<span id="cb7-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb7-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb7-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>)</span>
<span id="cb7-6">mdl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Random-Effects Model (k = 27; tau^2 estimator: REML)

tau^2 (estimated amount of total heterogeneity): 0.0564 (SE = 0.0230)
tau (square root of estimated tau^2 value):      0.2374
I^2 (total heterogeneity / total variability):   76.62%
H^2 (total variability / sampling variability):  4.28

Test for Heterogeneity:
Q(df = 26) = 91.9083, p-val &lt; .0001

Model Results:

estimate      se    tval  df    pval    ci.lb   ci.ub    
  0.0879  0.0576  1.5249  26  0.1394  -0.0306  0.2063    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We are pretty much able to reproduce the results seen in <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> with slight differences probably due to having to assume equal sample sizes between groups, using a different heterogeneity estimator and using the Hartung-Knapp-Sidik-Jonkman method for the confidence intervals. Let’s get the 95% prediction interval as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict.rma</span>(mdl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0879 0.0576 -0.0306 0.2063 -0.4143 0.5901 </code></pre>
</div>
</div>
<p>So, 95% of true effects fall between -.41 and .59 according to our model.</p>
</section>
<section id="rhs-analysis" class="level2">
<h2 class="anchored" data-anchor-id="rhs-analysis">R&amp;H’s analysis</h2>
<p>R&amp;H conduct a sub-group analysis by chopping up the studies into three bins. First issue here is that this analysis is completely post-hoc and who knows if they created these bins after trying various combinations to reach the conclusion that they desired. R&amp;H separate the 27 studies into three bins (this is verbatim from the article):</p>
<ol type="1">
<li><p><strong>Multi-week reduction experiments.</strong> These ten studies examined the impact of reducing social media use for at least two weeks, allowing withdrawal symptoms to dissipate.</p></li>
<li><p><strong>Short (one week or less) reduction experiments.</strong> These ten studies examined brief periods of abstinence from social media use, which are likely to pick up withdrawal symptoms from heavy users.</p></li>
<li><p><strong>Exposure experiments.</strong> In these seven studies, the ‘treatment’ is typically brief exposure to some kind of social media, such as requiring high school students to look at their Facebook or Instagram page for 10 minutes.</p></li>
</ol>
<p>The second problem we see is that the first two groups are separated by dichotomizing a naturally continuous variable (length of intervention). Sure it makes the data more digestible, but you simply lose information. This is generally considered bad statistical practice and we will see why a little later.</p>
<p>To reproduce R&amp;H’s analysis, we will add a column to the data set that denotes the group membership (1 = Multi-week reduction experiments, 2 = One week reduction experiments, 3 = Less than one week reduction experiments, 4 = Exposure experiments) of each study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subgroup =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alcott 2020</span></span>
<span id="cb11-3">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2020</span></span>
<span id="cb11-4">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2022</span></span>
<span id="cb11-5">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collins and Edgers 2022</span></span>
<span id="cb11-6">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Deters &amp; Mehl 2013</span></span>
<span id="cb11-7">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Faulhaber et al., 2023</span></span>
<span id="cb11-8">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gajdics 2022</span></span>
<span id="cb11-9">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hall et al. 2021</span></span>
<span id="cb11-10">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2018</span></span>
<span id="cb11-11">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2021</span></span>
<span id="cb11-12">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kleefeld dissertation</span></span>
<span id="cb11-13">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lambert 2022</span></span>
<span id="cb11-14">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lepp 2022</span></span>
<span id="cb11-15">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mahalingham 2023</span></span>
<span id="cb11-16">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mitev 2021</span></span>
<span id="cb11-17">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ozimek 2020</span></span>
<span id="cb11-18">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Przybylski 2021</span></span>
<span id="cb11-19">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sagioglou 2014 study 2"</span></span>
<span id="cb11-20">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tartaglia</span></span>
<span id="cb11-21">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2021</span></span>
<span id="cb11-22">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2023</span></span>
<span id="cb11-23">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tromholt 2016</span></span>
<span id="cb11-24">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valley2019</span></span>
<span id="cb11-25">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># van wezel 2021</span></span>
<span id="cb11-26">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vanman 2018</span></span>
<span id="cb11-27">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ward 2017</span></span>
<span id="cb11-28">                      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Yuen et al., 2019</span></span>
<span id="cb11-29">                      ))</span>
<span id="cb11-30"></span>
<span id="cb11-31"></span>
<span id="cb11-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display updated dataset</span></span>
<span id="cb11-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subgroup"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Citation                    n      d       v subgroup
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 Alcott 2020              1661  0.09  0.00241        1
2 Brailovskaia 2020         286  0.154 0.0141         1
3 Brailovskaia 2022         322  0     0.0125         1
4 Collins and Edgers 2022   121 -0.138 0.0337         1
5 Deters &amp; Mehl 2013         86 -0.207 0.0479         4
6 Faulhaber et al., 2023    230  0.484 0.0181         1</code></pre>
</div>
</div>
<p>Now that we have the subgroup column, we can conduct the sub-group analysis. Here comes the next problem, R&amp;H decide to simply calculates the arithmetic (unweighted) mean of the observed effect sizes within each group. The problem is that they aren’t capitalizing on the fact that different studies have different levels of precision. The only way it would make sense to compute an unweighted average with respect to the statistical model we are employing is if sampling error didn’t exist (it does) or heterogeneity is infinite (its not), so either way its just the wrong approach.</p>
<p>Let’s first reproduce R&amp;H’s results by taking the unweighted average of observed effect sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.data =</span> dat,</span>
<span id="cb13-2">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_d =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(d),</span>
<span id="cb13-3">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k_studies =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb13-4">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> subgroup)</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># reorder the subgroup display</span></span>
<span id="cb13-7">results[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  subgroup  mean_d k_studies
     &lt;dbl&gt;   &lt;dbl&gt;     &lt;int&gt;
1        1  0.204         10
2        2  0.0868         6
3        3 -0.172          4
4        4  0.0566         7</code></pre>
</div>
</div>
<p>All the values are accurate. We can compare it to the table shown in R&amp;H’s article:</p>
<p><img src="https://matthewbjane.com/blog-posts/table1-2-3_R&amp;H.png" class="img-fluid"></p>
<p>Okay we see a positive average effect for the multi-week reduction experiments, but lets now use proper inverse-variance weights to calculate the average. This time we will model the groups as dummy predictors and specify the proper contrasts for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># construct a meta-analytic model with subgroup</span></span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># as a dummy-coded categorical predictor</span></span>
<span id="cb15-3">mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(subgroup,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)), </span>
<span id="cb15-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v, </span>
<span id="cb15-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb15-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>)</span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># acquire subgroup-level mean estimates</span></span>
<span id="cb15-9">estimates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(</span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(mdl, </span>
<span id="cb15-11">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb15-12">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb15-13">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb15-14">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">g4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))))</span>
<span id="cb15-15"></span>
<span id="cb15-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print results</span></span>
<span id="cb15-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_delta =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pred),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group mean_delta
1     1      0.177
2     2      0.154
3     3     -0.172
4     4      0.082</code></pre>
</div>
</div>
<p>As we can see the estimates are a bit different. Another thing that is completely missing from the R&amp;H analysis is any indication of variability in their mean estimates and their is no indication of heterogeneity. It is conveyed as a fixed quantity, however just because we combine many studies together does not mean that uncertainty ceases to exist.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb17-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_delta =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pred,</span>
<span id="cb17-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CI_low =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ci.lb,</span>
<span id="cb17-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CI_high =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ci.ub,</span>
<span id="cb17-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PI_low =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pi.lb,</span>
<span id="cb17-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PI_high =</span> estimates<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pi.ub),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  group mean_delta CI_low CI_high PI_low PI_high
1     1      0.177 -0.005   0.360 -0.296   0.651
2     2      0.154 -0.098   0.407 -0.350   0.659
3     3     -0.172 -0.443   0.099 -0.686   0.342
4     4      0.082 -0.151   0.315 -0.414   0.577</code></pre>
</div>
</div>
<p>True effects for group 1 (multi-week reduction studies, i.e., the focal group) are quite variable and can range from -0.296 to 0.651. An interesting point to bring up is that <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> set the smallest effect size of interest (SESOI) to be <em>d</em> = .21 in his pre-registration (equivalent to a Pearson correlation of <em>r</em> = .10). However, that does not help us much here since the upper bound of the confidence interval is well above <em>d</em> = .21 so you can’t really make the claim that that there is no clinically meaningful effect, <em>on average</em>. And you definitely can’t make the claim that all/most true effects are not clinically meaningful since the upper bound of the PI is 0.651. Truthfully, the SESOI established in <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span> does not seem to have any good theoretical or practical justification outside of “seems reasonable” so it is unclear what the utility of this arbitrary boundary is in this case?</p>
</section>
<section id="properly-modeling-the-length-of-intervention-in-reduction-studies" class="level2">
<h2 class="anchored" data-anchor-id="properly-modeling-the-length-of-intervention-in-reduction-studies">Properly modeling the length of intervention in reduction studies</h2>
<p>Instead of binning the length of the intervention into groups I will use the weeks reported in the R&amp;H article to create a continuous moderator for reduction studies only.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_weeks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alcott 2020</span></span>
<span id="cb19-3">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2020</span></span>
<span id="cb19-4">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brailovskaia 2022</span></span>
<span id="cb19-5">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collins and Edgers 2022</span></span>
<span id="cb19-6">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Deters &amp; Mehl 2013</span></span>
<span id="cb19-7">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Faulhaber et al., 2023</span></span>
<span id="cb19-8">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gajdics 2022</span></span>
<span id="cb19-9">                          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hall et al. 2021</span></span>
<span id="cb19-10">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2018</span></span>
<span id="cb19-11">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hunt 2021</span></span>
<span id="cb19-12">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kleefeld dissertation</span></span>
<span id="cb19-13">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lambert 2022</span></span>
<span id="cb19-14">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lepp 2022</span></span>
<span id="cb19-15">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mahalingham 2023</span></span>
<span id="cb19-16">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mitev 2021</span></span>
<span id="cb19-17">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ozimek 2020</span></span>
<span id="cb19-18">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Przybylski 2021</span></span>
<span id="cb19-19">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sagioglou 2014 study 2"</span></span>
<span id="cb19-20">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tartaglia</span></span>
<span id="cb19-21">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2021</span></span>
<span id="cb19-22">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai 2023</span></span>
<span id="cb19-23">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tromholt 2016</span></span>
<span id="cb19-24">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valley2019</span></span>
<span id="cb19-25">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># van wezel 2021</span></span>
<span id="cb19-26">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vanman 2018</span></span>
<span id="cb19-27">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ward 2017</span></span>
<span id="cb19-28">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Yuen et al., 2019</span></span>
<span id="cb19-29">  ))</span>
<span id="cb19-30"></span>
<span id="cb19-31"></span>
<span id="cb19-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display updated dataset</span></span>
<span id="cb19-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Citation"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"d"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_weeks"</span>)])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Citation                    n      d       v length_weeks
  &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;
1 Alcott 2020              1661  0.09  0.00241            4
2 Brailovskaia 2020         286  0.154 0.0141             2
3 Brailovskaia 2022         322  0     0.0125             2
4 Collins and Edgers 2022   121 -0.138 0.0337            10
5 Deters &amp; Mehl 2013         86 -0.207 0.0479            NA
6 Faulhaber et al., 2023    230  0.484 0.0181             2</code></pre>
</div>
</div>
<p>Okay so now we have the moderator we can construct a linear meta-regression model of the form,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad_i%20=%20b_0%20+%20b_1%20X_%5Cmathrm%7Blength%7D%20+%20u_i%20+%20%5Cvarepsilon_i%0A"> Notice now that true effects how is distributed around the regression line such that the distribution of true effects is now</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20%5Csim%20%5Cmathcal%7BN%7D(b_0%20+%20b_1%20X_%5Cmathrm%7Blength%7D,%5Ctau%5E2)%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">mdl_weeks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rma</span>(d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> length_weeks,</span>
<span id="cb21-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vi =</span> v,</span>
<span id="cb21-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb21-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REML"</span>,</span>
<span id="cb21-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">test =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"knha"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 7 studies with NAs omitted from model fitting.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">mdl_weeks</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mixed-Effects Model (k = 20; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0647 (SE = 0.0299)
tau (square root of estimated tau^2 value):             0.2544
I^2 (residual heterogeneity / unaccounted variability): 79.40%
H^2 (unaccounted variability / sampling variability):   4.85
R^2 (amount of heterogeneity accounted for):            0.00%

Test for Residual Heterogeneity:
QE(df = 18) = 75.7503, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 18) = 0.0018, p-val = 0.9667

Model Results:

              estimate      se    tval  df    pval    ci.lb   ci.ub    
intrcpt         0.0884  0.0922  0.9581  18  0.3507  -0.1054  0.2821    
length_weeks    0.0014  0.0330  0.0423  18  0.9667  -0.0678  0.0706    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Okay so as it turns out there appears to be little/no effect of the length of the intervention on the effect size. Let us plot out the data to see what the relationship actually looks like:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-6_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<p>The regression line looks almost parallel to the <em>d</em> = 0 line (the grey line). You may notice the outlier at 10 weeks and you may want to remove it from the analysis. I would ask why? The data point does not appear to be a coding error or a mistake? It is a valid data point and piece of evidence that should not be taken out of the analysis post-hoc. Hell, it could be that the the positive effect of not being on social media only lasts a few weeks and then fades out (not an uncommon trend in psychology interventions). Anyways, any reason to remove that “outlier” would seem to me like a post-hoc rationalization.</p>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>The re-analysis of <span class="citation" data-cites="ferguson2024">Ferguson (2024)</span>’s meta-analysis by R&amp;H does not have adequate statistical rigor to build a “case for causality”. Post-hoc subgroup analyses conducted by R&amp;H did not use a principled statistical model, they did not report any variability in their estimates, the estimates themselves were sub-optimal (unweighted averaging), and they misinterpreted the point-estimates that they calculated. They did not do a proper comparison of their point-estimates and instead they treated them as fixed quantities and simply claimed that these average effect sizes are different without consideration of variability in their estimation procedure. Their conclusion claimed that:</p>
<blockquote class="blockquote">
<p>we still found that his data <em>supports</em> (rather than undermines) the contention by some scholars that “reductions in social media time would improve adolescent mental health,” at least as long as the reductions continue for two weeks or longer.</p>
</blockquote>
<p>Based on my re-analysis of R&amp;H’s re-analysis I find that the intervention length when modeled properly as a continuous variable (since it literally is) does not support this claim.</p>
<p>If I did anything incorrectly or if I did not use best practices, I take full responsibility and you can let me know by sending me a DM on twitter or emailing me at matthewbjane@gmail.com.</p>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-ferguson2024" class="csl-entry">
Ferguson, Christopher J. 2024. <span>“Do Social Media Experiments Prove a Link with Mental Health: A Methodological and Meta-Analytic Review.”</span> <em>Psychology of Popular Media</em>, No Pagination Specified–. <a href="https://doi.org/10.1037/ppm0000541">https://doi.org/10.1037/ppm0000541</a>.
</div>
</div></section></div> ]]></description>
  <category>meta-analysis</category>
  <category>social media</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-6.html</guid>
  <pubDate>Thu, 29 Aug 2024 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Respectful Operationalism, Realism, and Models of Measurement Error in Psychometrics</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-5.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="some-useful-definitions" class="level2">
<h2 class="anchored" data-anchor-id="some-useful-definitions">Some useful definitions</h2>
<p>Let us first note that when I refer to a <strong>measurand</strong> I simply mean the (psychological) attribute that we intend to measure.</p>
<p>A <strong>realist</strong> defines the measurand outside of the measurement procedure, that is, the measurand is some test-independent attribute that is estimated by scores produced by the test.</p>
<p>An <strong>operationalist</strong> would instead suppose that the measurand is defined by the test itself and can not be defined outside of the test (i.e., the measurand is test-dependent). Note that a <em>strict</em> operationalist in the form that I discuss in this blog post is a sort of extreme operationalist. In the measurement error modeling section, I also describe a <em>laxed operationalist</em>, but it is just a useful descriptor for contrasting two types of operationalist measurement models.</p>
<p>A <strong>respectful operationalist</strong> is an operationalist that defines the measurand in terms of the test, but the test is validated for extra-operational meanings and usability <span class="citation" data-cites="vessonen2021">(i.e., meanings and usability beyond the test, Vessonen 2021)</span>. So the respectful operationalist is kind of like “sure, yeah we can define the measurand in terms of the test, but the test needs to incorporate common connotations of the target concept and produce usable scores”.</p>
</section>
<section id="what-might-validity-look-like-in-each-of-these-frameworks" class="level2">
<h2 class="anchored" data-anchor-id="what-might-validity-look-like-in-each-of-these-frameworks">What might validity look like in each of these frameworks</h2>
<p>In <strong>realist</strong> framework, validity may fall under the principles set by <span class="citation" data-cites="borsboom2004">Borsboom, Mellenbergh, and Van Heerden (2004)</span>, where the psychological attribute (or construct) has to both 1) exist and 2) cause variation in the measurement procedure. This view of validity is centered around construct validity.</p>
<p>A (strict) <strong>operationalist</strong> need not validate a measure, even if the measure is nonsensical, the measurand is still defined by the test.</p>
<p>A <strong>respectful operationalist</strong> can validate a measure using a similar approach to Michael T. Kane’s argument-based approach to validity in which he guides researchers to specify and justify the intended use of the measure. Specifically, <span class="citation" data-cites="vessonen2021">Vessonen (2021)</span> proposes that a test is valid if the test incorporates common extra-operational connotations of the target concept. This will be more closely related to test-related types of validity such as content and criterion validity.</p>
</section>
<section id="operationalist-and-realist-measurement-error-models" class="level2">
<h2 class="anchored" data-anchor-id="operationalist-and-realist-measurement-error-models">Operationalist and Realist Measurement Error Models</h2>
<p>Okay let’s start at the foundation: we observe a test score <img src="https://latex.codecogs.com/png.latex?X_p"> for a person, <img src="https://latex.codecogs.com/png.latex?p">.</p>
<p><strong>A strict operationalist</strong> may simply define a person’s <em>true</em> score <img src="https://latex.codecogs.com/png.latex?T_p"> as the observed score such that, <img src="https://latex.codecogs.com/png.latex?T_p%20=%20X_p">. Trivially, the observed score can be modeled <em>as</em> the true score,</p>
<p><span id="eq-1"><img src="https://latex.codecogs.com/png.latex?%0AX_p%20=%20T_p%0A%5Ctag%7B1%7D"></span></p>
<p>There is something attractive and so practical about this model, however there are immediate problems of usability. What if we test that person again and they obtain a different score? What if the scoring is done by a rater and a different rater assigns a different score to that person? To answer this, let us use an example where a person’s true score is defined as the observed score <img src="https://latex.codecogs.com/png.latex?X_%7Bpar%7D">, for person <img src="https://latex.codecogs.com/png.latex?p">, test administration <img src="https://latex.codecogs.com/png.latex?a">, and rater <img src="https://latex.codecogs.com/png.latex?r"> such that,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20X_%7Bpar%7D%0A"></p>
<p>However the problem now is that if the observed score varies across test-administrations and/or raters then the true score will not be generalizable across test-administrations or raters,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20X_%7Bpar%7D%20%5Cneq%20X_%7Bpa(r+1)%7D%20%5Cneq%20X_%7Bp(a+1)r%7D%0A"></p>
<p>This will force us to define a true score for not only each person, but <em>also</em> each test administration and rater such that,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_%7Bpar%7D%20=%20X_%7Bpar%7D.%0A"></p>
<p>However differences in observed scores between test-administration and raters may not be of scientific interest if we only really care about person-level differences. This specific operationalist approach is simply unusable in practice. Although, it is interesting to note, that the reliability of observed scores is necessarily perfect and can be shown by the reliability index, <img src="https://latex.codecogs.com/png.latex?%5Crho_%7BXT%7D=1"> (i.e., the correlation between true and observed scores).</p>
<p>A more <strong>laxed operationalist</strong> definition of true scores would be to define it based on the <em>expectation</em> of observed scores conditional on a person. Therefore a definition of a true score for a given person can be expressed by,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20%5Cmathbb%7BE%7D%5BX_%7Bpar%7D%5Cmid%20p%5D%0A"></p>
<p>Conditional expectation (<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Ccdot%5D">) is the average observed score over all possible observed scores for a given person. This also provides the beautiful property that <img src="https://latex.codecogs.com/png.latex?X_%7Bp%7D"> for a given person, is <em>calibrated</em> to <img src="https://latex.codecogs.com/png.latex?T_p">, since,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20-%20%20%5Cmathbb%7BE%7D%5BX_p%5Cmid%20p%5D%20=%20T_p%20-%20T_p%20=%20%200.%0A"></p>
<p>So now, even if observed scores vary across raters and/or test administrations, the true score will remain constant. The question at this point is how can we model a single instance of an observed score. Here, we will need to introduce measurement errors. <strong>Measurement errors</strong> can be defined as differences between observed scores and true scores. Remember that in our strict operationalist model (Equation&nbsp;1) we did not have any measurement errors since the true score was equivalent to the observed score (i.e., if <img src="https://latex.codecogs.com/png.latex?T_p%20=%20X_p">, then <img src="https://latex.codecogs.com/png.latex?T_p%20-%20X_p%20=%200">). Now that the true score is the conditional expectation of the observed score, a single instance of an observed score <em>can</em> differ from the true score. We can thus add a new term to the model described in Equation&nbsp;1,</p>
<p><span id="eq-ctt"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bp%7D%20=%20T_p%20+%20E_%7Bp%7D,%0A%5Ctag%7B2%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?E_%7Bp%7D"> indicates the error in the observed score for a given person and measurement. Since we started with the definition of true scores being <img src="https://latex.codecogs.com/png.latex?T_p%20=%20%5Cmathbb%7BE%7D%5BX%20%5Cmid%20%20p%5D">, an extremely useful consequence of this is that the conditional expectation of measurement errors within a person is zero. We can demonstrate why this is the case with a short derivation (first re-arranging Equation&nbsp;2 so that <img src="https://latex.codecogs.com/png.latex?E_%7Bp%7D"> is on the left hand side),</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Cmathbb%7BE%7D%5BE_%7Bp%7D%5Cmid%20p%5D%20&amp;=%20%5Cmathbb%7BE%7D%5BT_p%20-%20%20X_p%5Cmid%20p%5D%20%5C%5C%5B.3em%5D%0A&amp;=%20%5Cmathbb%7BE%7D%5BT_p%5Cmid%20p%5D%20-%20%20%5Cmathbb%7BE%7D%5BX_p%5Cmid%20p%5D%20%5C%5C%5B.3em%5D%0A&amp;=%20T_p%20-%20%20T_p%20%5C%5C%5B.3em%5D%0A&amp;=%200%20%5C%5C%0A%5Cend%7Balign%7D"></p>
<p>Errors that balance out over all possible observed scores for a given person is what distinguishes the classical test theory model from other measurement models <span class="citation" data-cites="kroc2020">(Kroc and Zumbo 2020)</span>. It is important to note that the algebraic formulation of <img src="https://latex.codecogs.com/png.latex?X=T+E"> is <strong>not</strong> what defines the classical test theory model, in fact, many measurement error models come in an analogous form. It is the conditional expectations between the components of the model which distinguish classical errors from other measurement error models <span class="citation" data-cites="kroc2020">(e.g., Berkson errors, see Kroc and Zumbo 2020)</span>.</p>
<p><strong>A realist</strong> model may suppose that the true score is a construct score that is an objective value that is defined outside of the measurement operations (the actual value of the construct/attribute being measured; <span class="citation" data-cites="borsboom2002">Borsboom and Mellenbergh (2002)</span>). Therefore we can not define true scores in terms of observed scores without knowing how observed scores are calibrated true scores. The realist model for an observed score is superficially identical to Equation&nbsp;2,</p>
<p><span id="eq-nctt"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bp%7D%20=%20T_p%20+%20E_%7Bp%7D,%0A%5Ctag%7B3%7D"></span></p>
<p>with the major difference being that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX%7Cp%5D%20%5Cneq%20T_p">. Note that Equation&nbsp;3 is <em>not</em> the classical test theory model because it does not, by default, meet the assumptions of classical test theory that the laxed operationalist model does (Equation&nbsp;2). The big difference between this realist model the laxed operationalist model is that the conditional expectation of errors is no longer zero in the realist approach, and thus systematic errors (i.e., biased estimates of true scores) can exist. In order to recover proper calibration of the observed scores to true scores, we would have to just assume that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BE_p%5Cmid%20p%5D=0"> (see flaws below).</p>
<p>When it comes to psychological constructs the realist approach has two major flaws to me.</p>
<ol type="1">
<li><p>Necessitates the existence of a construct score that is independent of the measure. Without sufficient evidence of a construct existing, we are adding additional complexity to our theory. Therefore it adds increased complexity into our theory.</p></li>
<li><p>Even if the construct is real and has a true construct score, we have no idea how the observed scores are calibrated to those true scores. The operationalist model produces a calibrated measure by definition whereas the realist model needs to add an additional assumption (i.e., conditioned on a given person, the expectation of measurement errors is zero) in order for the observed scores to be calibrated.</p></li>
</ol>
<p>The operationalist model may have the biggest flaw so far:</p>
<ol type="1">
<li>Since the measurand is defined by the measure itself, you can not really draw any meaningful inferences about anything outside of the measure.</li>
</ol>
<p>There is a third option though!</p>
</section>
<section id="respectful-operationalist-measurement-error-model" class="level2">
<h2 class="anchored" data-anchor-id="respectful-operationalist-measurement-error-model">Respectful Operationalist Measurement Error Model</h2>
<p>As put by the originator of Respectful Operationalism Elina <span class="citation" data-cites="vessonen2021">Vessonen (2021)</span> states,</p>
<blockquote class="blockquote">
<p>[Respectful Operationalism] is the view that we may define a target concept in terms of a test, as long as that test is validated to incorporate common connotations of the target concept and the usability of the measure</p>
</blockquote>
<p>Therefore we need to identify which observed scores are produced by tests that have been validated for extra-operational connotations for the concept of interest. We generally have inter-subjective agreement about the meanings of concepts like intelligence, anxiety, and depression mean outside of the measurement instrument. We can imagine that items contain content that are more or less related to those inter-subjective meanings. The extent to which the item content is relevant to the concept of interest reflects the item’s <strong>content validity</strong>. The true score can be defined as the conditional expectation of observed scores obtained from tests containing items that are sufficiently valid (this could be done from inter-rater assessment of the conceptual relatedness of items and concepts) can define the true scores. that contain sufficient validity. Let’s define an observed score produced by a sufficiently valid test as <img src="https://latex.codecogs.com/png.latex?X_p%5E%5Cstar">. As an example, a measure of depression that produces observed scores from responses to the question, “what is your age?”, would not encompass common connotations of depression and therefore those observed scores would <em>not</em> in the set of <em>valid</em> observed scores. This new model can be defined as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX%5E%5Cstar_p%20=%20T_p%20+%20E_p%0A"></p>
<p>where</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20%5Cmathbb%7BE%7D%5BX%5E%5Cstar_p%5Cmid%20p%5D%0A"></p>
<p>In this way, inferences about concepts can be made from observed scores since they hold inherent relevance by virtue of prior validation of the test’s extra-operational meaning.</p>
</section>
<section id="my-current-stance" class="level2">
<h2 class="anchored" data-anchor-id="my-current-stance">My current stance</h2>
<p>Respectful operationalism appears to offer the practical advantages of operationalism such as calibrated measurement outcomes, without the limitation of being unable to draw meaningful inferences beyond the test. To consider myself a realist for a particular attribute/construct, then I would have to be sufficiently convinced of the tenants of construct validity described by <span class="citation" data-cites="borsboom2004">Borsboom, Mellenbergh, and Van Heerden (2004)</span>: (1) the attribute exists (2) the construct causes variation in outcomes of the measurement procedure. Currently, I am not sufficiently convinced this is the case this is the case for most (if not all) psychological constructs; therefore, I am not comfortable making the commitments necessary to take on a realist position. Therefore, to me, a know-nothin grad student, Respectful Operationalism seems to best align with my current worldview.</p>
<p>Further reading, see these papers by Elina Vessonen <span class="citation" data-cites="vessonen2019 vessonen2021">(2019, 2021)</span>.</p>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-borsboom2002" class="csl-entry">
Borsboom, Denny, and Gideon J Mellenbergh. 2002. <span>“True Scores, Latent Variables, and Constructs: A Comment on Schmidt and Hunter.”</span>
</div>
<div id="ref-borsboom2004" class="csl-entry">
Borsboom, Denny, Gideon J. Mellenbergh, and Jaap Van Heerden. 2004. <span>“The Concept of Validity.”</span> <em>Psychological Review</em> 111 (4): 1061–71. <a href="https://doi.org/10.1037/0033-295X.111.4.1061">https://doi.org/10.1037/0033-295X.111.4.1061</a>.
</div>
<div id="ref-kroc2020" class="csl-entry">
Kroc, Edward, and Bruno D. Zumbo. 2020. <span>“A Transdisciplinary View of Measurement Error Models and the Variations of x=t+e.”</span> <em>Journal of Mathematical Psychology</em> 98 (September): 102372. <a href="https://doi.org/10.1016/j.jmp.2020.102372">https://doi.org/10.1016/j.jmp.2020.102372</a>.
</div>
<div id="ref-vessonen2019" class="csl-entry">
Vessonen, Elina. 2019. <span>“Operationalism and Realism in Psychometrics.”</span> <em>Philosophy Compass</em> 14 (10): e12624. <a href="https://doi.org/10.1111/phc3.12624">https://doi.org/10.1111/phc3.12624</a>.
</div>
<div id="ref-vessonen2021" class="csl-entry">
———. 2021. <span>“Respectful Operationalism.”</span> <em>Theory &amp; Psychology</em> 31 (1): 84–105. <a href="https://doi.org/10.1177/0959354320945036">https://doi.org/10.1177/0959354320945036</a>.
</div>
</div></section></div> ]]></description>
  <category>psychological measurement</category>
  <category>measurement error</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-5.html</guid>
  <pubDate>Fri, 02 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>A Response to Jonathan Haidt’s response</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-4.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="defining-a-squared-effect-size" class="level2">
<h2 class="anchored" data-anchor-id="defining-a-squared-effect-size">Defining a Squared Effect Size</h2>
<p>Sometimes squared effect sizes are used in order to interpret results (e.g., <img src="https://latex.codecogs.com/png.latex?R%5E2">, <img src="https://latex.codecogs.com/png.latex?%5Ceta%5E2">). However these squared indices are biased in small sample sizes. To see why this is the case we can describe the mathematically. Generally, lets say we have some observed effect size <img src="https://latex.codecogs.com/png.latex?h_i"> for a sample <img src="https://latex.codecogs.com/png.latex?i">. This can be modeled as a function of a population correlation <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> and sampling error <img src="https://latex.codecogs.com/png.latex?e_i">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah_i%20=%20%5Ctheta%20+%20e_i%0A"></p>
<p>Where the expectation of <img src="https://latex.codecogs.com/png.latex?h_i"> (i.e., the average) upon repeated sampling is equal to <img src="https://latex.codecogs.com/png.latex?%5Ctheta">. More importantly for us, the expectation of sampling error <img src="https://latex.codecogs.com/png.latex?e_i"> across repeated samples would be zero. For the expectation of <img src="https://latex.codecogs.com/png.latex?e_i"> to be zero, <img src="https://latex.codecogs.com/png.latex?e"> would need to be randomly distributed around zero with both positive and negative values. Let us see what happens to the model once we square both sides to obtain <img src="https://latex.codecogs.com/png.latex?h%5E2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah%5E2_i%20=%20(%5Ctheta%20+%20e_i)%5E2%0A"></p>
<p>and thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah%5E2_i%20=%20%5Ctheta%5E2%20+%202%5Ctheta%20e_i%20+%20e_i%5E2%0A"></p>
<p>The squared effect sizes is now no longer an unbiased estimate of theta. The bias in <img src="https://latex.codecogs.com/png.latex?h_i%5E2"> can be seen by taking the expected value of both sides (note that the <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BVar%7D(e_i)"> is the sampling error variance and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Ccdot%5D"> is the expected value or the mean across repeated samples):</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Cmathbb%7BE%7D%5Bh%5E2_i%5D%20&amp;%20=%20%5Cmathbb%7BE%7D%5B%5Ctheta%5E2%20+%202%5Ctheta%20e_i%20+%20e_i%5E2%5D%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%202%5Ctheta%20%5Ctimes%20%5Cmathbb%7BE%7D%5Be_i%5D%20+%20%5Cmathbb%7BE%7D%5Be%5E2_i%5D%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Cmathbb%7BE%7D%5Be_i%5E2%5D%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Cleft(%5Ctext%7BVar%7D%5Be_i%5D%20+%20%5Cmathbb%7BE%7D%5Be_i%5D%5E2%5Cright)%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Ctext%7BVar%7D%5Be_i%5D%20%5C%5C%0A%5Cend%7Balign%7D">
<p>Since the sampling error variance is always positive (unless the sample size was infinite…), there will be a positive bias in expected value of <img src="https://latex.codecogs.com/png.latex?h_i%5E2">. It is important to note that the variance in sampling error (i.e., <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BVar%7D(e_i)">) will be larger with smaller sample sizes.</p>
</section>
<section id="simulated-example" class="level2">
<h2 class="anchored" data-anchor-id="simulated-example">Simulated Example</h2>
<p>Lets assume that in the population, the squared correlation between predicted and observed outcome (<img src="https://latex.codecogs.com/png.latex?R%5E2">) is zero, that is, the independent variables (<img src="https://latex.codecogs.com/png.latex?X_1">,<img src="https://latex.codecogs.com/png.latex?X_2">, and <img src="https://latex.codecogs.com/png.latex?X_3">) do not explain any variance in the dependent variable (<img src="https://latex.codecogs.com/png.latex?Y">). Lets simulate two studies, where one study has a sample size of 100 and the other has a sample size of 25. Then lets replicate these studies 5,000 times. In the first figure we will see that the mean value of <img src="https://latex.codecogs.com/png.latex?R%5E2"> is not zero even though the population value is. And with the smaller sample sizes within each study (<img src="https://latex.codecogs.com/png.latex?N%20=%2025">), the mean <img src="https://latex.codecogs.com/png.latex?R%5E2"> is larger. The plots below show the distribution of <img src="https://latex.codecogs.com/png.latex?R%5E2"> using the <code>ggdist</code> package <span class="citation" data-cites="kay">(<strong>kay?</strong>)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ThemePark)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(latex2exp)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb1-9">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">R21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> R22 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> R23 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb1-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb1-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb1-14">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-15">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-16">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-18">  </span>
<span id="cb1-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb1-20">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3)</span>
<span id="cb1-21">  R21[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb1-22"></span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb1-24">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span>
<span id="cb1-25">  R22[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb1-26">}</span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29">h1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(R21)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>], </span>
<span id="cb1-32">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'light'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-36">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-37">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$R^2$"</span>), </span>
<span id="cb1-39">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N='</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', Ave $R^2$='</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(R21),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span>
<span id="cb1-40"></span>
<span id="cb1-41">h2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(R22)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>], </span>
<span id="cb1-44">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'light'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-49">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$R^2$"</span>), </span>
<span id="cb1-51">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N='</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', Ave $R^2$='</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(R22),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span>
<span id="cb1-52">  </span>
<span id="cb1-53">h1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> h2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f1f9fa"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f1f9fa"</span>)))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we were to run a meta-analysis on all 5,000 studies and found a meta-analytic average <img src="https://latex.codecogs.com/png.latex?R%5E2"> of .13, we may conclude that there is a meaningful prediction/effect, however, this could simply be an artifact of sampling error. The plot below shows how the mean <img src="https://latex.codecogs.com/png.latex?R%5E2"> changes as you vary the sample size.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb2-4">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-5"></span>
<span id="cb2-6">R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb2-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb2-8">  N[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb2-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb2-10">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-11">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-12">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-13">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb2-15">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1)</span>
<span id="cb2-16">  R2[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb2-17">}</span>
<span id="cb2-18"></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(N,R2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_smooth</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb2-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb2-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb2-26">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean $R^2$"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Size"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In a meta-analysis, it is always best to use directional effect sizes that can be both positive and negative such as Cohen’s <img src="https://latex.codecogs.com/png.latex?d">’s or Pearson correlations. There are other strategies for meta-analyzing <img src="https://latex.codecogs.com/png.latex?R%5E2"> values such as using individual person data meta-analysis (using the raw data for each study) or meta-analyzing the correlation matrix between predictors and outcomes first and then running the regression model on the meta-analytic correlation matrix (this would not allow for non-linear terms though). If it is necessary to meta-analyze <img src="https://latex.codecogs.com/png.latex?R%5E2"> you will want to use the adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> value. See the plot below that shows the adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> across different sample sizes</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb3-4">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-5"></span>
<span id="cb3-6">R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb3-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb3-8">  N[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb3-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb3-10">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-11">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-12">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-13">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb3-15">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1)</span>
<span id="cb3-16">  R2[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>adj.r.squared</span>
<span id="cb3-17">}</span>
<span id="cb3-18"></span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(N,R2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_smooth</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb3-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb3-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb3-26">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean adj. $R^2$"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Size"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-30"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>sampling error</category>
  <category>artifacts</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-4.html</guid>
  <pubDate>Mon, 06 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Calculating Pre/Post Correlation from a Paired T-Test</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-3.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="step-1-obtain-the-necessary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="step-1-obtain-the-necessary-statistics">Step 1: Obtain the necessary statistics</h2>
<p>In order to calculate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">), we need the standard deviation (SD) of pre-test scores (<img src="https://latex.codecogs.com/png.latex?SD_%7Bpre%7D">), the SD of post-test scores (<img src="https://latex.codecogs.com/png.latex?SD_%7Bpost%7D">), the mean change (<img src="https://latex.codecogs.com/png.latex?M_%7Bchange%7D">), the paired t-statistic (<img src="https://latex.codecogs.com/png.latex?t">), the sample size (<img src="https://latex.codecogs.com/png.latex?N">). In this blog post, we are assuming that the change score standard deviation (<img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">) is unavailable to us. If the pre-test SD is available, but the post-test SD is unavailable, you can approximate the post-test SD by, first, taking average ratio of the pre-test SD and post-test SD from <img src="https://latex.codecogs.com/png.latex?k"> studies in the current meta-analysis (<img src="https://latex.codecogs.com/png.latex?%5Coverline%7BSD%7D_%7Bratio%7D">; see the blog post on 9/8/2023), then we can approximate the post-test SD by multiplying the pre-test SD by the average SD ratio,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bpost%7D%5Capprox%20%5Cbar%7BSD%7D_%7Bratio%7D%5Ctimes%20SD_%7Bpre%7D%0A"></p>
<p>A rougher approximation would be to simply set the pre-test SD and post-test SD to be equal. If the study reports an F-statistic from a one-way repeated measures ANOVA, the F-statistic is equal to the square of the t-statistic,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0At%20=%20%5Csqrt%7BF%7D%0A"></p>
<p>Ensure that you apply the correct sign (negative or positive) to the t-statistic, since the F-statistic is always positive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain values</span></span>
<span id="cb1-2">M_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-3">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb1-4">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb1-5">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.50</span></span>
<span id="cb1-6">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span></code></pre></div>
</div>
</section>
<section id="step-2-calculate-the-prepost-correlation" class="level2">
<h2 class="anchored" data-anchor-id="step-2-calculate-the-prepost-correlation">Step 2: Calculate the Pre/Post Correlation</h2>
<p>Lets start by figuring out how to find the change score SD. The paired t-statistic is defined as the mean change score divided by the standard error of change scores, such that, <img src="https://latex.codecogs.com/png.latex?%0At%20=%20%5Cfrac%7BM_%7Bchange%7D%7D%7BSE_%7Bchange%7D%7D%0A"> Since we need the change score SD, we can use the definition of the standard error of the mean to put the t-statistic in terms of <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">: <img src="https://latex.codecogs.com/png.latex?%0ASE_%7Bchange%7D=%5Cfrac%7BSD_%7Bchange%7D%7D%7B%5Csqrt%7BN%7D%7D%0A"> and therefore <img src="https://latex.codecogs.com/png.latex?t"> can be expressed as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0At=%5Cfrac%7BM_%7Bchange%7D%7D%7B%5Cleft(%5Cfrac%7BSD_%7Bchange%7D%7D%7B%5Csqrt%7BN%7D%7D%5Cright)%7D%0A"></p>
<p>then we just need to solve for <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bchange%7D=%5Cfrac%7BM_%7Bchange%7D%5Ctimes%5Csqrt%7BN%7D%7D%7Bt%7D%0A"></p>
<p>Okay so now let us recall the definition of change score SDs from the blog post on 9/8/2023. In that blog we discussed how to obtain the pre/post correlation from the change score SD, now that we have converted <img src="https://latex.codecogs.com/png.latex?t"> to <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">, we can solve for the correlation in a similar way. First things first, the change score SD can be defined as, <img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bchange%7D%20=%20%5Csqrt%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%202%5Ctimes%20r%5Ctimes%20SD_%7Bpre%7DSD_%7Bpost%7D%7D%0A"></p>
<p>We can re-arrange this to isolate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%20SD%5E2_%7Bchange%7D%7D%7B2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%7D%0A"></p>
<p>In our case, the study did not report the change score SD, therefore we can replace it with our derived <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D"> from a paired t-test:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%20%5Cleft(%5Cfrac%7BM_%7Bchange%7D%5Ctimes%5Csqrt%7BN%7D%7D%7Bt%7D%5Cright)%20%5E2%7D%7B2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%7D%0A"> Lets neaten this formulation up a tad:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7Bt%5E2%5Cleft(SD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%5Cright)%20-%20N%5Ctimes%20M%5E2_%7Bchange%7D%20%7D%7B2%20%5Ctimes%20t%5E2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%20%7D%0A"></p>
<p>Isn’t that just a beautiful thing?? So there you have it! the full equation for the pre/post correlation from a paired t-test! Note that this is a direct conversion and not merely an approximation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb2-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> M_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(r,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.657"</code></pre>
</div>
</div>
</section>
<section id="applying-it-to-a-simulated-dataset" class="level2">
<h2 class="anchored" data-anchor-id="applying-it-to-a-simulated-dataset">Applying it to a simulated dataset</h2>
<p>We can simulate correlated pre/post scores from a bivariate Gaussian with known parameters. The calculated correlation is exactly correct!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages('MASS')</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define parameters</span></span>
<span id="cb4-5">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb4-6">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb4-7">r_true <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb4-8">M_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-9">M_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb4-10">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate correlated pre/post scores from bivariate gaussian</span></span>
<span id="cb4-13">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mvrnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span>N,</span>
<span id="cb4-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(M_pre,M_post),</span>
<span id="cb4-15">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Sigma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post),</span>
<span id="cb4-16">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post,SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb4-17">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">empirical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb4-20">x_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-test scores</span></span>
<span id="cb4-21">x_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-test scores</span></span>
<span id="cb4-22">x_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_pre <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate change scores</span></span>
<span id="cb4-23"></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate standard deviations, t-stats, and mean change</span></span>
<span id="cb4-25">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_pre)</span>
<span id="cb4-26">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_post)</span>
<span id="cb4-27">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x_change) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_change)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(N))</span>
<span id="cb4-28">M_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x_change)</span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb4-31">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> M_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post)</span>
<span id="cb4-32"></span>
<span id="cb4-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print results</span></span>
<span id="cb4-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,r))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.7"</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>repeated measures</category>
  <category>pre/post correlations</category>
  <category>test statistics</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-3.html</guid>
  <pubDate>Wed, 13 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Approximating Standard Deviation from Inter-Quantile Range</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-2.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="inter-quantile-range" class="level3">
<h3 class="anchored" data-anchor-id="inter-quantile-range">Inter-Quantile Range</h3>
<p>Studies may report inter-quantile ranges in order to communicate the spread of the data. However, meta-analysts will need standard deviations (SD) to calculate effect size estimates such as standardized mean differences (i.e., Cohen’s <img src="https://latex.codecogs.com/png.latex?d">). For this post, we will focus on the inter-<em>quartile</em> range (IQR) although the method described here will apply to any range between a pair of quantiles. The IQR (<img src="https://latex.codecogs.com/png.latex?X_%7B(75-25)%7D">) is defined as the difference between the 75th and 25th quantile values, that is, the region where 50% of the data lies. We can visualize what this will look like with normally distributed data:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s compare the range of values covered by +/- 1 SDs of a normal distribution:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The range covered by <img src="https://latex.codecogs.com/png.latex?%5Cpm%201"> SD covers a considerably larger range of values than the IQR.</p>
</section>
<section id="step-2-convert-iqr-to-standard-deviations" class="level3">
<h3 class="anchored" data-anchor-id="step-2-convert-iqr-to-standard-deviations">Step 2: Convert IQR to Standard Deviations</h3>
<p>The quantile function (<img src="https://latex.codecogs.com/png.latex?%5Cphi%5E%7B-1%7D">) of the standard normal distribution (i.e., mean=0, SD=1) converts quantiles of the cumulative density function into the corresponding values in standard deviation units. The difference between the corresponding values will give us the IQR in SD units,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7B(75-25)%7D%20=%20%5Cphi%5E%7B-1%7D(.75)%20-%20%5Cphi%5E%7B-1%7D(.25)%0A"> The resulting value is <img src="https://latex.codecogs.com/png.latex?S_%7B(75-25)%7D=1.34898">. It is important to note that this formulation can be used for any set of quantiles not just IQR, therefore we can generalized this to compare any arbitrary pair of quantiles (<img src="https://latex.codecogs.com/png.latex?Q1,Q2">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7B(Q_2-Q_1)%7D%20=%20%5Cphi%5E%7B-1%7D(Q_2)%20-%20%5Cphi%5E%7B-1%7D(Q_1)%0A"></p>
<p>Now that we have the IQR in terms of SD units, we can divide with the raw IQR to obtain an estimate of the SD of <img src="https://latex.codecogs.com/png.latex?X"> (<img src="https://latex.codecogs.com/png.latex?S_X">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_X%20=%20%20%5Cfrac%7BX_%7B(75-25)%7D%7D%7BS_%7B(75-25)%7D%7D%20=%20%5Cfrac%7BX_%7B(75-25)%7D%7D%7B1.34898%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define IQR</span></span>
<span id="cb1-2">X_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb1-3">X_75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb1-4">X_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_75 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X_25</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute IQR in SDs</span></span>
<span id="cb1-7">S_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Estimate standard deviation</span></span>
<span id="cb1-10">S_X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  X_75_25 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> S_75_25</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print results</span></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(S_X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.82602</code></pre>
</div>
</div>
</section>
<section id="note-the-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="note-the-assumptions">Note the Assumptions!</h2>
<p>Since this method provides an approximation of a normal distribution it is important to point out that the method may be biased under different distributions. For example, if we try the same method on a Student’s t distribution with heavy tails (3.5 degrees of freedom), <img src="https://latex.codecogs.com/png.latex?S_%7B(75-25)%7D"> would be equal to 1.50187 which is slightly larger than 1.34898 that we computed from the normal distribution. If we were to assume a normal distribution when it was truly a student’s t, the method would over-estimate the standard deviation by ~11%.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="applying-it-to-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="applying-it-to-simulated-data">Applying it to simulated data</h3>
<p>Lets see how it performs in simulated sample of normally distributed data… Close enough!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set seed</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate normal data (Mean = 10, SD = 5)</span></span>
<span id="cb3-5">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define IQR</span></span>
<span id="cb3-8">q25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(X,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span>
<span id="cb3-9">q75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(X,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>))</span>
<span id="cb3-10">X_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q75 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q25</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute IQR in SD units</span></span>
<span id="cb3-13">S_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Estimate standard deviation</span></span>
<span id="cb3-16">S_X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  X_75_25 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> S_75_25</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(S_X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.706901</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>
</section>

 ]]></description>
  <category>standard deviations</category>
  <category>approximations</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-2.html</guid>
  <pubDate>Sun, 10 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Calculating Pre/Post Correlation from the Standard Deviation of Change Scores</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-1.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="step-1-obtain-pre-test-post-test-and-change-score-standard-deviations" class="level2">
<h2 class="anchored" data-anchor-id="step-1-obtain-pre-test-post-test-and-change-score-standard-deviations">Step 1: Obtain Pre-test, Post-test, and Change score standard deviations</h2>
<p>In order to calculate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">), we need an estimate of the standard deviation (SD) of pre-test scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bpre%7D">), the SD of post-test scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bpost%7D">), and the SD of change scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bchange%7D">, where <img src="https://latex.codecogs.com/png.latex?x_%7Bchange%7D=x_%7Bpost%7D-x_%7Bpre%7D">). If the post-test SD is unavailable, but the pre-test SD is available, you can approximate the post-test SD by, first, taking average ratio of the pre-test SD and post-test SD from <img src="https://latex.codecogs.com/png.latex?k"> studies in the current meta-analysis,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7BS%7D_%7Bratio%7D=%5Cfrac%7B1%7D%7Bk%7D%5Csum_%7Bi=1%7D%5Ek%20%5Cfrac%7BS_%7Bpost,i%7D%7D%7BS_%7Bpre,i%7D%7D%0A"> Then we can make an approximation of the post-test SD by multiplying the pre-test SD by the average SD ratio,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7Bpost%7D%5Capprox%20%5Cbar%7BS%7D_%7Bratio%7D%5Ctimes%20S_%7Bpre%7D%0A"></p>
<p>A rougher approximation would be to simply set the pre-test SD and post-test SD to be equal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define standard deviations</span></span>
<span id="cb1-2">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb1-3">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb1-4">S_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span></code></pre></div>
</div>
</section>
<section id="step-2-calculate-the-prepost-correlation" class="level2">
<h2 class="anchored" data-anchor-id="step-2-calculate-the-prepost-correlation">Step 2: Calculate the Pre/Post Correlation</h2>
<p>The correlation between pre-test and post-test scores (<img src="https://latex.codecogs.com/png.latex?r">) can be calculated by re-arranging the equation for change score SD:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7Bchange%7D%20=%20%5Csqrt%7BS%5E2_%7Bpre%7D%20+%20S%5E2_%7Bpost%7D%20-%202rS_%7Bpre%7DS_%7Bpost%7D%7D%0A"> Then we can solve for <img src="https://latex.codecogs.com/png.latex?r">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BS%5E2_%7Bpre%7D%20+%20S%5E2_%7Bpost%7D%20-%20S%5E2_%7Bchange%7D%7D%7B2S_%7Bpre%7DS_%7Bpost%7D%7D%0A"> Note that this is a direct conversion and not merely an approximation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb2-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> S_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(r,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.697"</code></pre>
</div>
</div>
</section>
<section id="applying-it-to-a-simulated-dataset" class="level2">
<h2 class="anchored" data-anchor-id="applying-it-to-a-simulated-dataset">Applying it to a simulated dataset</h2>
<p>We can simulate correlated pre/post scores from a bivariate Gaussian with known parameters. It can be seen that the correlation calculated from the formulas above is perfectly precise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages('MASS')</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define parameters</span></span>
<span id="cb4-5">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb4-6">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb4-7">r_true <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate correlated pre/post scores from bivariate gaussian</span></span>
<span id="cb4-10">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mvrnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb4-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Sigma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post),</span>
<span id="cb4-13">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post,S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb4-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">empirical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb4-17">x_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-test scores</span></span>
<span id="cb4-18">x_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-test scores</span></span>
<span id="cb4-19">x_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_pre <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate change scores</span></span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate standard deviations</span></span>
<span id="cb4-22">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_pre)</span>
<span id="cb4-23">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_post)</span>
<span id="cb4-24">S_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_change)</span>
<span id="cb4-25"></span>
<span id="cb4-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb4-27">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> S_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post)</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,r))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.7"</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>repeated measures</category>
  <category>pre/post correlations</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-1.html</guid>
  <pubDate>Fri, 08 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
</channel>
</rss>
