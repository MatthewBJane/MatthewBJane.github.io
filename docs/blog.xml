<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Matthew B. Jané</title>
<link>https://matthewbjane.com/blog.html</link>
<atom:link href="https://matthewbjane.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>Website for Matthew B. Jané. PhD student at the University of Connecticut.</description>
<generator>quarto-1.4.549</generator>
<lastBuildDate>Fri, 02 Feb 2024 05:00:00 GMT</lastBuildDate>
<item>
  <title>Respectful Operationalism, Realism, and Models of Measurement Error in Psychometrics</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-5.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<p><br></p>
<section id="some-useful-definitions" class="level2">
<h2 class="anchored" data-anchor-id="some-useful-definitions">Some useful definitions</h2>
<p>Let us first note that when I refer to a <strong>measurand</strong> I simply mean the (psychological) attribute that we intend to measure.</p>
<p>A <strong>realist</strong> defines the measurand outside of the measurement procedure, that is, the measurand is some test-independent attribute that is estimated by scores produced by the test.</p>
<p>An <strong>operationalist</strong> would instead suppose that the measurand is defined by the test itself and can not be defined outside of the test (i.e., the measurand is test-dependent). Note that a <em>strict</em> operationalist in the form that I discuss in this blog post is a sort of extreme operationalist. In the measurement error modeling section, I also describe a <em>laxed</em>, but it is just a useful descriptor for contrasting two types of operationalist measurement models.</p>
<p>A <strong>respectful operationalist</strong> is an operationalist that defines the measurand in terms of the test, but the test is validated for extra-operational meanings and usability <span class="citation" data-cites="vessonen2021">(i.e., meanings and usability beyond the test, Vessonen 2021)</span>. So the respectful operationalist is kind of like “sure, yeah we can define the measurand in terms of the test, but the test needs to incorporate common connotations of the target concept and produce usable scores”</p>
</section>
<section id="what-might-validity-look-like-in-each-of-these-frameworks" class="level2">
<h2 class="anchored" data-anchor-id="what-might-validity-look-like-in-each-of-these-frameworks">What might validity look like in each of these frameworks</h2>
<p>In <strong>realist</strong> framework, validity may fall under the principles set by <span class="citation" data-cites="borsboom2004">Borsboom, Mellenbergh, and Van Heerden (2004)</span>, where the psychological attribute (or construct) has to both 1) exist and 2) cause variation in the measurement procedure. This view of validity is centered around construct validity.</p>
<p>A (strict) <strong>operationalist</strong> need not validate a measure, even if the measure is nonsensical, the measurand is still defined by the test.</p>
<p>A <strong>respectful operationalist</strong> can validate a measure using a similar approach to Michael T. Kane’s argument-based approach to validity in which he guides researchers to specify and justify the intended use of the measure. Specifically, <span class="citation" data-cites="vessonen2021">Vessonen (2021)</span> proposes that a test is valid if the test incorporates common extra-operational connotations of the target concept. This will be more closely related to test-related types of validity such as content and criterion validity.</p>
</section>
<section id="operationalist-and-realist-measurement-error-models" class="level2">
<h2 class="anchored" data-anchor-id="operationalist-and-realist-measurement-error-models">Operationalist and Realist Measurement Error Models</h2>
<p>Okay let’s start at the foundation: we observe a test score <img src="https://latex.codecogs.com/png.latex?X_p"> for a person, <img src="https://latex.codecogs.com/png.latex?p">.</p>
<p><strong>A strict operationalist</strong> may simply define a person’s <em>true</em> score <img src="https://latex.codecogs.com/png.latex?T_p"> as the observed score such that, <img src="https://latex.codecogs.com/png.latex?T_p%20=%20X_p">. Trivially, the observed score can be modeled <em>as</em> the true score,</p>
<p><span id="eq-1"><img src="https://latex.codecogs.com/png.latex?%0AX_p%20=%20T_p%0A%5Ctag%7B1%7D"></span></p>
<p>There is something attractive and so practical about this model, however there are immediate problems of usability. What if we test that person again and they obtain a different score? What if the test is scored by a rater and a different rater assigns a different score to that person? To answer this, let us use an example where a person’s true score is defined as the observed score <img src="https://latex.codecogs.com/png.latex?X_%7Bpar%7D">, for person <img src="https://latex.codecogs.com/png.latex?p">, test administration <img src="https://latex.codecogs.com/png.latex?a">, and rater <img src="https://latex.codecogs.com/png.latex?r"> such that,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20X_%7Bpar%7D%0A"></p>
<p>However the problem now is that if the observed score varies across test-administrations and/or raters then the true score will not be generalizable across test-administrations or raters,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20X_%7Bpar%7D%20%5Cneq%20X_%7Bpa(r+1)%7D%20%5Cneq%20X_%7Bp(a+1)r%7D%0A"></p>
<p>This will force us to define a true score for not only each person, but <em>also</em> each test administration and rater such that,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_%7Bpar%7D%20=%20X_%7Bpar%7D.%0A"></p>
<p>However differences in observed scores between test-administration and raters may not be of scientific interest if we only really care about person-level differences. This specific operationalist approach is unusable in practice. Although, it is interesting to note, that the reliability of observed scores is necessarily perfect and can be shown by the reliability index, <img src="https://latex.codecogs.com/png.latex?%5Crho_%7BXT%7D=1"> (i.e., the correlation between true and observed scores).</p>
<p>A more <strong>laxed operationalist</strong> definition of true scores would be to define it based on the <em>expectation</em> of observed scores conditional on a person. Therefore a definition of a true score for a given person can be expressed by,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20%5Cmathbb%7BE%7D%5BX_%7Bp%7D%20%7C%20p%5D%0A"></p>
<p>Conditional expectation (<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Ccdot%5D">) is the average observed score over all possible observed scores for a given person. This also provides the beautiful property that <img src="https://latex.codecogs.com/png.latex?X_%7Bp%7D"> for a given person, is an “unbiased estimate” of <img src="https://latex.codecogs.com/png.latex?T_p">, since by the definition of statistical bias,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctextsf%7Bbias%7D%20=%20T_p%20-%20%20%5Cmathbb%7BE%7D%5BX_p%7Cp%5D%20=%20T_p%20-%20T_p%20=%20%200%0A"></p>
<p>So now, even if observed scores vary across raters and/or test administrations, the true score will remain constant. The question at this point is how to model a single instance of an observed score. Here, we will need to introduce a measurement errors. <strong>Measurement errors</strong> can be defined as differences between observed scores and true scores. Remember that in our strict operationalist model (Equation&nbsp;1) we did not have any measurement errors since the true score was equivalent to the observed score (i.e., if <img src="https://latex.codecogs.com/png.latex?T_p%20=%20X_p">, then <img src="https://latex.codecogs.com/png.latex?T_p%20-%20X_p%20=%200">). Now that the true score is the expected observed score for a given person, a single instance of an observed score <em>can</em> differ from the true score such that,</p>
<p><span id="eq-ctt"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bp%7D%20=%20T_p%20+%20E_%7Bp%7D%0A%5Ctag%7B2%7D"></span></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?E_%7Bp%7D"> indicates the error in the observed score for a given person and measurement. Since we started with the definition of true scores being <img src="https://latex.codecogs.com/png.latex?T_p%20=%20%5Cmathbb%7BE%7D%5BX%20%7C%20p%5D">, an extremely useful consequence of this is that the conditional expectation of measurement errors within a person is zero. We can demonstrate why this is the case with a short derivation (first re-arranging Equation&nbsp;2 so that <img src="https://latex.codecogs.com/png.latex?E_%7Bp%7D"> is on the left hand side),</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Cmathbb%7BE%7D%5BE_%7Bp%7D%7Cp%5D%20&amp;=%20%5Cmathbb%7BE%7D%5BT_p%20-%20%20X_p%7Cp%5D%20%5C%5C%5B.3em%5D%0A&amp;=%20%5Cmathbb%7BE%7D%5BT_p%7Cp%5D%20-%20%20%5Cmathbb%7BE%7D%5BX_p%7Cp%5D%20%5C%5C%5B.3em%5D%0A&amp;=%20T_p%20-%20%20T_p%20%5C%5C%5B.3em%5D%0A&amp;=%200%20%5C%5C%0A%5Cend%7Balign%7D"></p>
<p>Errors that balance out over all possible observed scores for a given person is what distinguishes the classical test theory model from other measurement models <span class="citation" data-cites="kroc2020">(Kroc and Zumbo 2020)</span>. It is important to note that the <img src="https://latex.codecogs.com/png.latex?X=T+E"> model is not what defines the classical test theory model, in fact, many measurement error models come in an analogous form, conditional expectations between the components of the model generally are what distinguish measurement error models across disciplines <span class="citation" data-cites="kroc2020">(Kroc and Zumbo 2020)</span>.</p>
<p><strong>A realist</strong> model may suppose that the true score is a construct score that is an objective value that is defined outside of the measurement (the actual value of the construct/attribute being measured; <span class="citation" data-cites="borsboom2002">Borsboom and Mellenbergh (2002)</span>). Therefore we can not define true scores in terms of observed scores. The model for an observed score is superficially identical to Equation&nbsp;2,</p>
<p><span id="eq-nctt"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bp%7D%20=%20T_p%20+%20E_%7Bp%7D%0A%5Ctag%7B3%7D"></span></p>
<p>With the major difference that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX%7Cp%5D%20%5Cneq%20T_p">. Note that Equation&nbsp;3 is <em>not</em> the classical test theory model because it does not, by default, meet the assumptions of classical test theory that the laxed operationalist model does (Equation&nbsp;2). The big difference between this realist model the laxed operationalist model is that the conditional expectation of errors is no longer zero in the realist approach, and thus systematic errors (i.e., biased estimates of true scores) can exist. In order to recover the unbiased estimate of true scores, we would have to just assume that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BE_p%5D=0"> (see flaws below).</p>
<p>When it comes to psychological constructs the realist approach has two major flaws to me.</p>
<ol type="1">
<li><p>An ontological commitment to the existence of an objective construct scores that exist independent of the measure. The problem with this is it includes an additional parameter with an undefined nature and lacking evidence of it’s existence. Therefore it adds increased complexity into our theory.</p></li>
<li><p>The operationalist model produces an unbiased measure by definition whereas the realist model needs to add an additional assumption (i.e., conditioned on a given person, the expectation of measurement errors is zero) in order for the observed scores to be unbiased.</p></li>
</ol>
<p>The operationalist model may have the biggest flaw so far:</p>
<ol type="1">
<li>You can not really draw any meaningful inferences about anything outside of the measure.</li>
</ol>
<p>There is a third option though!</p>
</section>
<section id="respectful-operationalist-measurement-error-model" class="level2">
<h2 class="anchored" data-anchor-id="respectful-operationalist-measurement-error-model">Respectful Operationalist Measurement Error Model</h2>
<p>As put by the originator of Respectful Operationalism Elina <span class="citation" data-cites="vessonen2021">Vessonen (2021)</span> states,</p>
<blockquote class="blockquote">
<p>[Respectful Operationalism] is the view that we may define a target concept in terms of a test, as long as that test is validated to incorporate common connotations of the target concept and the usability of the measure</p>
</blockquote>
<p>Therefore we need to identify which observed scores are produced by tests that have been validated for extra-operational connotations for the concept of interest. Let’s define an observed score produced by a sufficiently valid test as <img src="https://latex.codecogs.com/png.latex?X_p%5E%5Cstar"> which is contained in the set of all possible observed scores such that, <img src="https://latex.codecogs.com/png.latex?X_p%5E%5Cstar%20%5Cin%20X_p">. As an example, a measure of depression that produces observed scores from responses to the question, “what is your age?”, would not encompass common connotations of depression and therefore those observed scores would be in the total set of observed scores, but <em>not</em> in the set of <em>valid</em> observed scores. This new model can be defined as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX%5E%5Cstar_p%20=%20T_p%20+%20E_p%0A"></p>
<p>where</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT_p%20=%20%5Cmathbb%7BE%7D%5BX%5E%5Cstar_p%7Cp%5D%0A"></p>
<p>In this way, inferences about concepts can be made from observed scores since they hold inherent relevance by virtue of prior validation of the test’s extra-operational meaning.</p>
</section>
<section id="my-current-stance" class="level2">
<h2 class="anchored" data-anchor-id="my-current-stance">My current stance</h2>
<p>Respectful operationalism appears to offer the practical advantages of operationalism such as unbiased measurements, without the limitation of being unable to draw meaningful inferences beyond the test. To consider myself a realist, the measurand must be defined coherently with evidence supporting its existence. Currently, I do not believe this is the case for psychological constructs; therefore, I am not comfortable making the ontological commitments necessary for a realist standpoint. Therefore, to me, a know-nothin grad student, Respectful Operationalism seems to best align with my current beliefs.</p>
<p>Further reading, see these papers by Elina Vessonen <span class="citation" data-cites="vessonen2019 vessonen2021">(2019, 2021)</span>.</p>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #33333322; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-borsboom2002" class="csl-entry">
Borsboom, Denny, and Gideon J Mellenbergh. 2002. <span>“True Scores, Latent Variables, and Constructs: A Comment on Schmidt and Hunter.”</span>
</div>
<div id="ref-borsboom2004" class="csl-entry">
Borsboom, Denny, Gideon J. Mellenbergh, and Jaap Van Heerden. 2004. <span>“The Concept of Validity.”</span> <em>Psychological Review</em> 111 (4): 1061–71. <a href="https://doi.org/10.1037/0033-295X.111.4.1061">https://doi.org/10.1037/0033-295X.111.4.1061</a>.
</div>
<div id="ref-kroc2020" class="csl-entry">
Kroc, Edward, and Bruno D. Zumbo. 2020. <span>“A Transdisciplinary View of Measurement Error Models and the Variations of x=t+e.”</span> <em>Journal of Mathematical Psychology</em> 98 (September): 102372. <a href="https://doi.org/10.1016/j.jmp.2020.102372">https://doi.org/10.1016/j.jmp.2020.102372</a>.
</div>
<div id="ref-vessonen2019" class="csl-entry">
Vessonen, Elina. 2019. <span>“Operationalism and Realism in Psychometrics.”</span> <em>Philosophy Compass</em> 14 (10): e12624. <a href="https://doi.org/10.1111/phc3.12624">https://doi.org/10.1111/phc3.12624</a>.
</div>
<div id="ref-vessonen2021" class="csl-entry">
———. 2021. <span>“Respectful Operationalism.”</span> <em>Theory &amp; Psychology</em> 31 (1): 84–105. <a href="https://doi.org/10.1177/0959354320945036">https://doi.org/10.1177/0959354320945036</a>.
</div>
</div></section></div> ]]></description>
  <category>psychological measurement</category>
  <category>measurement error</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-5.html</guid>
  <pubDate>Fri, 02 Feb 2024 05:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Sampling Distributions of Squared Effect Sizes and their Implication for Meta-Analysis</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-4.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="defining-a-squared-effect-size" class="level2">
<h2 class="anchored" data-anchor-id="defining-a-squared-effect-size">Defining a Squared Effect Size</h2>
<p>Sometimes squared effect sizes are used in order to interpret results (e.g., <img src="https://latex.codecogs.com/png.latex?R%5E2">, <img src="https://latex.codecogs.com/png.latex?%5Ceta%5E2">). However these squared indices are biased in small sample sizes. To see why this is the case we can describe the mathematically. Generally, lets say we have some observed effect size <img src="https://latex.codecogs.com/png.latex?h_i"> for a sample <img src="https://latex.codecogs.com/png.latex?i">. This can be modeled as a function of a population correlation <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> and sampling error <img src="https://latex.codecogs.com/png.latex?e_i">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah_i%20=%20%5Ctheta%20+%20e_i%0A"></p>
<p>Where the expectation of <img src="https://latex.codecogs.com/png.latex?h_i"> (i.e., the average) upon repeated sampling is equal to <img src="https://latex.codecogs.com/png.latex?%5Ctheta">. More importantly for us, the expectation of sampling error <img src="https://latex.codecogs.com/png.latex?e_i"> across repeated samples would be zero. For the expectation of <img src="https://latex.codecogs.com/png.latex?e_i"> to be zero, <img src="https://latex.codecogs.com/png.latex?e"> would need to be randomly distributed around zero with both positive and negative values. Let us see what happens to the model once we square both sides to obtain <img src="https://latex.codecogs.com/png.latex?h%5E2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah%5E2_i%20=%20(%5Ctheta%20+%20e_i)%5E2%0A"></p>
<p>and thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah%5E2_i%20=%20%5Ctheta%5E2%20+%202%5Ctheta%20e_i%20+%20e_i%5E2%0A"></p>
<p>The squared effect sizes is now no longer an unbiased estimate of theta. The bias in <img src="https://latex.codecogs.com/png.latex?h_i%5E2"> can be seen by taking the expected value of both sides (note that the <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BVar%7D(e_i)"> is the sampling error variance and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Ccdot%5D"> is the expected value or the mean across repeated samples):</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Cmathbb%7BE%7D%5Bh%5E2_i%5D%20&amp;%20=%20%5Cmathbb%7BE%7D%5B%5Ctheta%5E2%20+%202%5Ctheta%20e_i%20+%20e_i%5E2%5D%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%202%5Ctheta%20%5Ctimes%20%5Cmathbb%7BE%7D%5Be_i%5D%20+%20%5Cmathbb%7BE%7D%5Be%5E2_i%5D%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Cmathbb%7BE%7D%5Be_i%5E2%5D%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Cleft(%5Ctext%7BVar%7D%5Be_i%5D%20+%20%5Cmathbb%7BE%7D%5Be_i%5D%5E2%5Cright)%20%5C%5C%5B.5em%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20=%20%5Ctheta%5E2%20+%20%5Ctext%7BVar%7D%5Be_i%5D%20%5C%5C%0A%5Cend%7Balign%7D">
<p>Since the sampling error variance is always positive (unless the sample size was infinite…), there will be a positive bias in expected value of <img src="https://latex.codecogs.com/png.latex?h_i%5E2">. It is important to note that the variance in sampling error (i.e., <img src="https://latex.codecogs.com/png.latex?%5Ctext%7BVar%7D(e_i)">) will be larger with smaller sample sizes.</p>
</section>
<section id="simulated-example" class="level2">
<h2 class="anchored" data-anchor-id="simulated-example">Simulated Example</h2>
<p>Lets assume that in the population, the squared correlation between predicted and observed outcome (<img src="https://latex.codecogs.com/png.latex?R%5E2">) is zero, that is, the independent variables (<img src="https://latex.codecogs.com/png.latex?X_1">,<img src="https://latex.codecogs.com/png.latex?X_2">, and <img src="https://latex.codecogs.com/png.latex?X_3">) do not explain any variance in the dependent variable (<img src="https://latex.codecogs.com/png.latex?Y">). Lets simulate two studies, where one study has a sample size of 100 and the other has a sample size of 25. Then lets replicate these studies 5,000 times. In the first figure we will see that the mean value of <img src="https://latex.codecogs.com/png.latex?R%5E2"> is not zero even though the population value is. And with the smaller sample sizes within each study (<img src="https://latex.codecogs.com/png.latex?N%20=%2025">), the mean <img src="https://latex.codecogs.com/png.latex?R%5E2"> is larger. The plots below show the distribution of <img src="https://latex.codecogs.com/png.latex?R%5E2"> using the <code>ggdist</code> package <span class="citation" data-cites="kay">(Kay 2023)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggdist)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ThemePark)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(latex2exp)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb1-9">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">R21 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> R22 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> R23 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb1-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb1-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb1-14">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-15">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-16">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-18">  </span>
<span id="cb1-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb1-20">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3)</span>
<span id="cb1-21">  R21[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb1-22"></span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb1-24">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x3,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subset =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>N,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span>
<span id="cb1-25">  R22[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb1-26">}</span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29">h1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(R21)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>], </span>
<span id="cb1-32">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'light'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-35">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-36">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-37">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$R^2$"</span>), </span>
<span id="cb1-39">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N='</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', Ave $R^2$='</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(R21),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span>
<span id="cb1-40"></span>
<span id="cb1-41">h2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(R22)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_slabinterval</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>], </span>
<span id="cb1-44">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'light'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb1-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb1-49">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$R^2$"</span>), </span>
<span id="cb1-51">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N='</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', Ave $R^2$='</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(R22),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span>
<span id="cb1-52">  </span>
<span id="cb1-53">h1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> h2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f1f9fa"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#f1f9fa"</span>)))</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we were to run a meta-analysis on all 5,000 studies and found a meta-analytic average <img src="https://latex.codecogs.com/png.latex?R%5E2"> of .13, we may conclude that there is a meaningful prediction/effect, however, this could simply be an artifact of sampling error. The plot below shows how the mean <img src="https://latex.codecogs.com/png.latex?R%5E2"> changes as you vary the sample size.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb2-4">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-5"></span>
<span id="cb2-6">R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb2-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb2-8">  N[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb2-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb2-10">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-11">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-12">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-13">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb2-15">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1)</span>
<span id="cb2-16">  R2[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>r.squared</span>
<span id="cb2-17">}</span>
<span id="cb2-18"></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(N,R2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_smooth</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb2-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb2-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb2-26">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean $R^2$"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Size"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-29"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In a meta-analysis, it is always best to use directional effect sizes that can be both positive and negative such as Cohen’s <img src="https://latex.codecogs.com/png.latex?d">’s or Pearson correlations. There are other strategies for meta-analyzing <img src="https://latex.codecogs.com/png.latex?R%5E2"> values such as using individual person data meta-analysis (using the raw data for each study) or meta-analyzing the correlation matrix between predictors and outcomes first and then running the regression model on the meta-analytic correlation matrix (this would not allow for non-linear terms though). If it is necessary to meta-analyze <img src="https://latex.codecogs.com/png.latex?R%5E2"> you will want to use the adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> value. See the plot below that shows the adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> across different sample sizes</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample size</span></span>
<span id="cb3-4">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-5"></span>
<span id="cb3-6">R2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>()</span>
<span id="cb3-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>){</span>
<span id="cb3-8">  N[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)</span>
<span id="cb3-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb3-10">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-11">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-12">  x3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-13">  y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(N[i] ,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># linear regression model</span></span>
<span id="cb3-15">  mdl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x1)</span>
<span id="cb3-16">  R2[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mdl)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>adj.r.squared</span>
<span id="cb3-17">}</span>
<span id="cb3-18"></span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(N,R2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_barbie</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">barbie_font =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stat_smooth</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> barbie_theme_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dark'</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb3-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb3-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#f1f9fa'</span>),</span>
<span id="cb3-26">        )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">TeX</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean adj. $R^2$"</span>),<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Size"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-30"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## `geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-kay" class="csl-entry">
Kay, Matthew. 2023. <span>“Ggdist: Visualizations of Distributions and Uncertainty in the Grammar of Graphics.”</span> <a href="https://doi.org/10.31219/osf.io/2gsz6">https://doi.org/10.31219/osf.io/2gsz6</a>.
</div>
</div></section></div> ]]></description>
  <category>sampling error</category>
  <category>artifacts</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-4.html</guid>
  <pubDate>Mon, 06 Nov 2023 05:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Calculating Pre/Post Correlation from a Paired T-Test</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-3.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="step-1-obtain-the-necessary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="step-1-obtain-the-necessary-statistics">Step 1: Obtain the necessary statistics</h2>
<p>In order to calculate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">), we need the standard deviation (SD) of pre-test scores (<img src="https://latex.codecogs.com/png.latex?SD_%7Bpre%7D">), the SD of post-test scores (<img src="https://latex.codecogs.com/png.latex?SD_%7Bpost%7D">), the mean change (<img src="https://latex.codecogs.com/png.latex?M_%7Bchange%7D">), the paired t-statistic (<img src="https://latex.codecogs.com/png.latex?t">), the sample size (<img src="https://latex.codecogs.com/png.latex?N">). In this blog post, we are assuming that the change score standard deviation (<img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">) is unavailable to us. If the pre-test SD is available, but the post-test SD is unavailable, you can approximate the post-test SD by, first, taking average ratio of the pre-test SD and post-test SD from <img src="https://latex.codecogs.com/png.latex?k"> studies in the current meta-analysis (<img src="https://latex.codecogs.com/png.latex?%5Coverline%7BSD%7D_%7Bratio%7D">; see the blog post on 9/8/2023), then we can approximate the post-test SD by multiplying the pre-test SD by the average SD ratio,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bpost%7D%5Capprox%20%5Cbar%7BSD%7D_%7Bratio%7D%5Ctimes%20SD_%7Bpre%7D%0A"></p>
<p>A rougher approximation would be to simply set the pre-test SD and post-test SD to be equal. If the study reports an F-statistic from a one-way repeated measures ANOVA, the F-statistic is equal to the square of the t-statistic,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0At%20=%20%5Csqrt%7BF%7D%0A"></p>
<p>Ensure that you apply the correct sign (negative or positive) to the t-statistic, since the F-statistic is always positive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain values</span></span>
<span id="cb1-2">M_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-3">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb1-4">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb1-5">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.50</span></span>
<span id="cb1-6">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span></code></pre></div>
</div>
</section>
<section id="step-2-calculate-the-prepost-correlation" class="level2">
<h2 class="anchored" data-anchor-id="step-2-calculate-the-prepost-correlation">Step 2: Calculate the Pre/Post Correlation</h2>
<p>Lets start by figuring out how to find the change score SD. The paired t-statistic is defined as the mean change score divided by the standard error of change scores, such that, <img src="https://latex.codecogs.com/png.latex?%0At%20=%20%5Cfrac%7BM_%7Bchange%7D%7D%7BSE_%7Bchange%7D%7D%0A"> Since we need the change score SD, we can use the definition of the standard error of the mean to put the t-statistic in terms of <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">: <img src="https://latex.codecogs.com/png.latex?%0ASE_%7Bchange%7D=%5Cfrac%7BSD_%7Bchange%7D%7D%7B%5Csqrt%7BN%7D%7D%0A"> and therefore <img src="https://latex.codecogs.com/png.latex?t"> can be expressed as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0At=%5Cfrac%7BM_%7Bchange%7D%7D%7B%5Cleft(%5Cfrac%7BSD_%7Bchange%7D%7D%7B%5Csqrt%7BN%7D%7D%5Cright)%7D%0A"></p>
<p>then we just need to solve for <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bchange%7D=%5Cfrac%7BM_%7Bchange%7D%5Ctimes%5Csqrt%7BN%7D%7D%7Bt%7D%0A"></p>
<p>Okay so now let us recall the definition of change score SDs from the blog post on 9/8/2023. In that blog we discussed how to obtain the pre/post correlation from the change score SD, now that we have converted <img src="https://latex.codecogs.com/png.latex?t"> to <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D">, we can solve for the correlation in a similar way. First things first, the change score SD can be defined as, <img src="https://latex.codecogs.com/png.latex?%0ASD_%7Bchange%7D%20=%20%5Csqrt%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%202%5Ctimes%20r%5Ctimes%20SD_%7Bpre%7DSD_%7Bpost%7D%7D%0A"></p>
<p>We can re-arrange this to isolate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%20SD%5E2_%7Bchange%7D%7D%7B2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%7D%0A"></p>
<p>In our case, the study did not report the change score SD, therefore we can replace it with our derived <img src="https://latex.codecogs.com/png.latex?SD_%7Bchange%7D"> from a paired t-test:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BSD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%20-%20%5Cleft(%5Cfrac%7BM_%7Bchange%7D%5Ctimes%5Csqrt%7BN%7D%7D%7Bt%7D%5Cright)%20%5E2%7D%7B2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%7D%0A"> Lets neaten this formulation up a tad:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7Bt%5E2%5Cleft(SD%5E2_%7Bpre%7D%20+%20SD%5E2_%7Bpost%7D%5Cright)%20-%20N%5Ctimes%20M%5E2_%7Bchange%7D%20%7D%7B2%20%5Ctimes%20t%5E2%20%5Ctimes%20SD_%7Bpre%7D%5Ctimes%20SD_%7Bpost%7D%20%7D%0A"></p>
<p>Isn’t that just a beautiful thing?? So there you have it! the full equation for the pre/post correlation from a paired t-test! Note that this is a direct conversion and not merely an approximation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb2-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> M_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(r,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.657"</code></pre>
</div>
</div>
</section>
<section id="applying-it-to-a-simulated-dataset" class="level2">
<h2 class="anchored" data-anchor-id="applying-it-to-a-simulated-dataset">Applying it to a simulated dataset</h2>
<p>We can simulate correlated pre/post scores from a bivariate Gaussian with known parameters. The calculated correlation is exactly correct!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages('MASS')</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define parameters</span></span>
<span id="cb4-5">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb4-6">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb4-7">r_true <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb4-8">M_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-9">M_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb4-10">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate correlated pre/post scores from bivariate gaussian</span></span>
<span id="cb4-13">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mvrnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span>N,</span>
<span id="cb4-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(M_pre,M_post),</span>
<span id="cb4-15">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Sigma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post),</span>
<span id="cb4-16">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post,SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb4-17">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">empirical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb4-20">x_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-test scores</span></span>
<span id="cb4-21">x_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-test scores</span></span>
<span id="cb4-22">x_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_pre <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate change scores</span></span>
<span id="cb4-23"></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate standard deviations, t-stats, and mean change</span></span>
<span id="cb4-25">SD_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_pre)</span>
<span id="cb4-26">SD_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_post)</span>
<span id="cb4-27">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x_change) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_change)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(N))</span>
<span id="cb4-28">M_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x_change)</span>
<span id="cb4-29"></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb4-31">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> SD_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> M_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>SD_post)</span>
<span id="cb4-32"></span>
<span id="cb4-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print results</span></span>
<span id="cb4-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,r))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.7"</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>repeated measures</category>
  <category>pre/post correlations</category>
  <category>test statistics</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-3.html</guid>
  <pubDate>Wed, 13 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Approximating Standard Deviation from Inter-Quantile Range</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-2.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="inter-quantile-range" class="level3">
<h3 class="anchored" data-anchor-id="inter-quantile-range">Inter-Quantile Range</h3>
<p>Studies may report inter-quantile ranges in order to communicate the spread of the data. However, meta-analysts will need standard deviations (SD) to calculate effect size estimates such as standardized mean differences (i.e., Cohen’s <img src="https://latex.codecogs.com/png.latex?d">). For this post, we will focus on the inter-<em>quartile</em> range (IQR) although the method described here will apply to any range between a pair of quantiles. The IQR (<img src="https://latex.codecogs.com/png.latex?X_%7B(75-25)%7D">) is defined as the difference between the 75th and 25th quantile values, that is, the region where 50% of the data lies. We can visualize what this will look like with normally distributed data:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s compare the range of values covered by +/- 1 SDs of a normal distribution:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The range covered by <img src="https://latex.codecogs.com/png.latex?%5Cpm%201"> SD covers a considerably larger range of values than the IQR.</p>
</section>
<section id="step-2-convert-iqr-to-standard-deviations" class="level3">
<h3 class="anchored" data-anchor-id="step-2-convert-iqr-to-standard-deviations">Step 2: Convert IQR to Standard Deviations</h3>
<p>The quantile function (<img src="https://latex.codecogs.com/png.latex?%5Cphi%5E%7B-1%7D">) of the standard normal distribution (i.e., mean=0, SD=1) converts quantiles of the cumulative density function into the corresponding values in standard deviation units. The difference between the corresponding values will give us the IQR in SD units,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7B(75-25)%7D%20=%20%5Cphi%5E%7B-1%7D(.75)%20-%20%5Cphi%5E%7B-1%7D(.25)%0A"> The resulting value is <img src="https://latex.codecogs.com/png.latex?S_%7B(75-25)%7D=1.34898">. It is important to note that this formulation can be used for any set of quantiles not just IQR, therefore we can generalized this to compare any arbitrary pair of quantiles (<img src="https://latex.codecogs.com/png.latex?Q1,Q2">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7B(Q_2-Q_1)%7D%20=%20%5Cphi%5E%7B-1%7D(Q_2)%20-%20%5Cphi%5E%7B-1%7D(Q_1)%0A"></p>
<p>Now that we have the IQR in terms of SD units, we can divide with the raw IQR to obtain an estimate of the SD of <img src="https://latex.codecogs.com/png.latex?X"> (<img src="https://latex.codecogs.com/png.latex?S_X">),</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_X%20=%20%20%5Cfrac%7BX_%7B(75-25)%7D%7D%7BS_%7B(75-25)%7D%7D%20=%20%5Cfrac%7BX_%7B(75-25)%7D%7D%7B1.34898%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define IQR</span></span>
<span id="cb1-2">X_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb1-3">X_75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb1-4">X_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> X_75 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X_25</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute IQR in SDs</span></span>
<span id="cb1-7">S_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Estimate standard deviation</span></span>
<span id="cb1-10">S_X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  X_75_25 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> S_75_25</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#print results</span></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(S_X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.82602</code></pre>
</div>
</div>
</section>
<section id="note-the-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="note-the-assumptions">Note the Assumptions!</h2>
<p>Since this method provides an approximation of a normal distribution it is important to point out that the method may be biased under different distributions. For example, if we try the same method on a Student’s t distribution with heavy tails (3.5 degrees of freedom), <img src="https://latex.codecogs.com/png.latex?S_%7B(75-25)%7D"> would be equal to 1.50187 which is slightly larger than 1.34898 that we computed from the normal distribution. If we were to assume a normal distribution when it was truly a student’s t, the method would over-estimate the standard deviation by ~11%.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://matthewbjane.com/blog-posts/blog-post-2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="applying-it-to-simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="applying-it-to-simulated-data">Applying it to simulated data</h3>
<p>Lets see how it performs in simulated sample of normally distributed data… Close enough!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set seed</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">343</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate normal data (Mean = 10, SD = 5)</span></span>
<span id="cb3-5">X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define IQR</span></span>
<span id="cb3-8">q25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(X,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>))</span>
<span id="cb3-9">q75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(X,.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>))</span>
<span id="cb3-10">X_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> q75 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> q25</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute IQR in SD units</span></span>
<span id="cb3-13">S_75_25 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Estimate standard deviation</span></span>
<span id="cb3-16">S_X <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  X_75_25 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> S_75_25</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb3-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(S_X)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.706901</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>
</section>

 ]]></description>
  <category>standard deviations</category>
  <category>approximations</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-2.html</guid>
  <pubDate>Sun, 10 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Calculating Pre/Post Correlation from the Standard Deviation of Change Scores</title>
  <dc:creator>Matthew B. Jané</dc:creator>
  <link>https://matthewbjane.com/blog-posts/blog-post-1.html</link>
  <description><![CDATA[ 




<a href="https://www.buymeacoffee.com/matthewbjane"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=☕&amp;slug=matthewbjane&amp;button_colour=ed5c9b&amp;font_colour=ffffff&amp;font_family=Arial&amp;outline_colour=ffffff&amp;coffee_colour=ffffff"></a>
<section id="step-1-obtain-pre-test-post-test-and-change-score-standard-deviations" class="level2">
<h2 class="anchored" data-anchor-id="step-1-obtain-pre-test-post-test-and-change-score-standard-deviations">Step 1: Obtain Pre-test, Post-test, and Change score standard deviations</h2>
<p>In order to calculate the pre/post correlation (<img src="https://latex.codecogs.com/png.latex?r">), we need an estimate of the standard deviation (SD) of pre-test scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bpre%7D">), the SD of post-test scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bpost%7D">), and the SD of change scores (<img src="https://latex.codecogs.com/png.latex?S_%7Bchange%7D">, where <img src="https://latex.codecogs.com/png.latex?x_%7Bchange%7D=x_%7Bpost%7D-x_%7Bpre%7D">). If the post-test SD is unavailable, but the pre-test SD is available, you can approximate the post-test SD by, first, taking average ratio of the pre-test SD and post-test SD from <img src="https://latex.codecogs.com/png.latex?k"> studies in the current meta-analysis,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7BS%7D_%7Bratio%7D=%5Cfrac%7B1%7D%7Bk%7D%5Csum_%7Bi=1%7D%5Ek%20%5Cfrac%7BS_%7Bpost,i%7D%7D%7BS_%7Bpre,i%7D%7D%0A"> Then we can make an approximation of the post-test SD by multiplying the pre-test SD by the average SD ratio,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7Bpost%7D%5Capprox%20%5Cbar%7BS%7D_%7Bratio%7D%5Ctimes%20S_%7Bpre%7D%0A"></p>
<p>A rougher approximation would be to simply set the pre-test SD and post-test SD to be equal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define standard deviations</span></span>
<span id="cb1-2">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb1-3">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb1-4">S_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span></code></pre></div>
</div>
</section>
<section id="step-2-calculate-the-prepost-correlation" class="level2">
<h2 class="anchored" data-anchor-id="step-2-calculate-the-prepost-correlation">Step 2: Calculate the Pre/Post Correlation</h2>
<p>The correlation between pre-test and post-test scores (<img src="https://latex.codecogs.com/png.latex?r">) can be calculated by re-arranging the equation for change score SD:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_%7Bchange%7D%20=%20%5Csqrt%7BS%5E2_%7Bpre%7D%20+%20S%5E2_%7Bpost%7D%20-%202rS_%7Bpre%7DS_%7Bpost%7D%7D%0A"> Then we can solve for <img src="https://latex.codecogs.com/png.latex?r">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar%20=%20%5Cfrac%7BS%5E2_%7Bpre%7D%20+%20S%5E2_%7Bpost%7D%20-%20S%5E2_%7Bchange%7D%7D%7B2S_%7Bpre%7DS_%7Bpost%7D%7D%0A"> Note that this is a direct conversion and not merely an approximation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb2-2">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> S_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print results</span></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(r,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.697"</code></pre>
</div>
</div>
</section>
<section id="applying-it-to-a-simulated-dataset" class="level2">
<h2 class="anchored" data-anchor-id="applying-it-to-a-simulated-dataset">Applying it to a simulated dataset</h2>
<p>We can simulate correlated pre/post scores from a bivariate Gaussian with known parameters. It can be seen that the correlation calculated from the formulas above is perfectly precise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages('MASS')</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define parameters</span></span>
<span id="cb4-5">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span></span>
<span id="cb4-6">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb4-7">r_true <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulate correlated pre/post scores from bivariate gaussian</span></span>
<span id="cb4-10">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mvrnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb4-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mu=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Sigma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post),</span>
<span id="cb4-13">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(r_true<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post,S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb4-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">empirical =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtain simulated scores</span></span>
<span id="cb4-17">x_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-test scores</span></span>
<span id="cb4-18">x_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-test scores</span></span>
<span id="cb4-19">x_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_post <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_pre <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate change scores</span></span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate standard deviations</span></span>
<span id="cb4-22">S_pre <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_pre)</span>
<span id="cb4-23">S_post <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_post)</span>
<span id="cb4-24">S_change <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x_change)</span>
<span id="cb4-25"></span>
<span id="cb4-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate pre/post correlation</span></span>
<span id="cb4-27">r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> S_post<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> S_change<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_pre<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>S_post)</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r = '</span>,r))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "r = 0.7"</code></pre>
</div>
</div>
<iframe src="https://embeds.beehiiv.com/f3ffd81a-4723-4419-bb1d-afc8af3bac36" data-test-id="beehiiv-embed" width="100%" height="320" frameborder="0" scrolling="no" style="border-radius: 4px; border: 2px solid #e5e7eb; margin: 0; background-color: transparent;">
</iframe>


</section>

 ]]></description>
  <category>repeated measures</category>
  <category>pre/post correlations</category>
  <guid>https://matthewbjane.com/blog-posts/blog-post-1.html</guid>
  <pubDate>Fri, 08 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://matthewbjane.com/blog-posts/blog-image.png" medium="image" type="image/png" height="96" width="144"/>
</item>
</channel>
</rss>
